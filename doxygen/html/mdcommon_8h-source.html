<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>src/include/mdcommon.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>src/include/mdcommon.h</h1><a href="mdcommon_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00057"></a>00057 <span class="preprocessor">#ifndef MD_COMMON</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span><span class="preprocessor">#define MD_COMMON</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>
<a name="l00060"></a>00060 <span class="preprocessor">#include&lt;boost/asio/datagram_socket_service.hpp&gt;</span>
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="keyword">using namespace </span>std;
<a name="l00063"></a>00063 <span class="keyword">using</span> boost::asio::ip::udp;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="preprocessor">#define MAX_CLIENTS                  1000</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span><span class="preprocessor">#define MAX_CLIEVER                  10</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span><span class="preprocessor">#define MAX_DATACLIENTS              200</span>
<a name="l00068"></a>00068 <span class="preprocessor"></span><span class="preprocessor">#define MAX_INSTRUMENTS              3        // Per Cliever cluster.</span>
<a name="l00069"></a>00069 <span class="preprocessor"></span><span class="preprocessor">#define MAX_DEBUG                    1000     // Set the config parm higher than this to inhibit logNdebug(m...) where m &lt; this</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span><span class="preprocessor">#define MAX_DEVICE                   (((MAX_CLIEVER + 1) * MAX_INSTRUMENTS) + MAX_DATACLIENTS)</span>
<a name="l00071"></a>00071 <span class="preprocessor"></span><span class="preprocessor">#ifndef MD_STAGE</span>
<a name="l00072"></a>00072 <span class="preprocessor"></span><span class="preprocessor">#define CD_DEFAULT_IP                "192.168.0.9"</span>
<a name="l00073"></a>00073 <span class="preprocessor"></span><span class="preprocessor">#define MD_DEFAULT_IP                "192.168.0.5"</span>
<a name="l00074"></a>00074 <span class="preprocessor"></span><span class="preprocessor">#define PULL_MD_LOG                  "cp /somejuan/tmp/auc-md.log ."</span>
<a name="l00075"></a>00075 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00076"></a>00076 <span class="preprocessor"></span><span class="preprocessor">#define CD_DEFAULT_IP                "184.168.64.86"</span>
<a name="l00077"></a>00077 <span class="preprocessor"></span><span class="preprocessor">#define MD_DEFAULT_IP                "178.79.142.228"</span>
<a name="l00078"></a>00078 <span class="preprocessor"></span><span class="preprocessor">#define PULL_MD_LOG                  ("scp daclips</span><span class="stringliteral">@" MD_DEFAULT_IP "</span>/tmp/auc-md.log .")
<a name="l00079"></a>00079 <span class="preprocessor">#endif</span>
<a name="l00080"></a>00080 <span class="preprocessor"></span><span class="preprocessor">#define MD_EPOCH                     date()           </span>
<a name="l00081"></a>00081 <span class="preprocessor"></span><span class="preprocessor">#define MD_HEARTBEAT                 1            // Network peer heartbeat in seconds.</span>
<a name="l00082"></a>00082 <span class="preprocessor"></span><span class="preprocessor">#define MD_MAX_DATAGRAM              (32*1024)    // half of the IPV4 max</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span><span class="preprocessor">#define DACLIPS_APP                  "Generic"</span>
<a name="l00084"></a>00084 <span class="preprocessor"></span><span class="preprocessor">#define MD_COMPONENT                 "Master Daemon" // DACLIPS Component</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span><span class="preprocessor">#define MD_NAME                      DACLIPS_APP " " MD_COMPONENT </span>
<a name="l00086"></a>00086 <span class="preprocessor"></span><span class="preprocessor">#define MD_VERSION                   " 1.1 "      // DACLIPS Version</span>
<a name="l00087"></a>00087 <span class="preprocessor"></span><span class="preprocessor">#define MD_REFRESH                   10           // default milliseconds between telemetry frame updates</span>
<a name="l00088"></a>00088 <span class="preprocessor"></span><span class="preprocessor">#define MD_TYPE                      "CENTRIFUGE" // i.e. what a MACHINE is, Change per your DACLIPS derivation</span>
<a name="l00089"></a>00089 <span class="preprocessor"></span><span class="preprocessor">#define NORMAL_DEBUG                 10  </span>
<a name="l00090"></a>00090 <span class="preprocessor"></span><span class="preprocessor">#ifndef CURRENT_DEBUG</span>
<a name="l00091"></a>00091 <span class="preprocessor"></span><span class="preprocessor">#define CURRENT_DEBUG                NORMAL_DEBUG</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span><span class="preprocessor">#define NOT_OK                       -1</span>
<a name="l00094"></a>00094 <span class="preprocessor"></span><span class="preprocessor">#define OK                           0</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span><span class="preprocessor">#define RUNNING_DIR                  "/tmp"</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span>
<a name="l00097"></a>00097 <span class="preprocessor">#define theMachine                   thisConfig-&gt;machine[thisConfig-&gt;thisMachineContext]</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span>
<a name="l00099"></a><a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b09438">00099</a> <span class="keyword">enum</span> <a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b09438">md_mand</a> {
<a name="l00100"></a><a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b0943889707fed22bed38e2434420d3f7b13cc">00100</a>   <a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b0943889707fed22bed38e2434420d3f7b13cc">MD_NAM</a>,                            <span class="comment">// Not a Mand.</span>
<a name="l00101"></a><a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b094382c3067eaf0563298e7ae51f401484d91">00101</a>   <a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b094382c3067eaf0563298e7ae51f401484d91">MD_USER_MAND</a>,                      <span class="comment">// User defined mand type</span>
<a name="l00102"></a><a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b094387f2b1643563d422e92be688a1b7e3428">00102</a>   <a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b094387f2b1643563d422e92be688a1b7e3428">MD_SCPI</a>,                           
<a name="l00103"></a><a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b094380682c89b0bbfe641a74b85b0f5d15527">00103</a>   <a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b094380682c89b0bbfe641a74b85b0f5d15527">MD_RULE_ACTION</a>,
<a name="l00104"></a><a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b0943810354e52c3278888732d188227e1599f">00104</a>   <a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b0943810354e52c3278888732d188227e1599f">MD_CLIEVER_CMD</a>,                    <span class="comment">// From CD command loop or other UI</span>
<a name="l00105"></a><a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b09438546900190179d3812f743f28b56a3497">00105</a>   <a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b09438546900190179d3812f743f28b56a3497">MD_CLIENT_CMD</a>,                     <span class="comment">// From XMLRPC </span>
<a name="l00106"></a><a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b09438007eb6f868ca85015c75e4ae456eb17b">00106</a>   <a class="code" href="mdcommon_8h.html#2cdbc4bd01bf049b2850ec3977b09438007eb6f868ca85015c75e4ae456eb17b">MD_NMANDS</a> 
<a name="l00107"></a>00107 };
<a name="l00108"></a>00108 
<a name="l00109"></a><a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f1">00109</a> <span class="keyword">enum</span> <a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f1">mdErrorCode</a> {                   <span class="comment">// In auc-md/kb index to masterDaemonConfig.err</span>
<a name="l00110"></a><a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f1c79a00dd543cb06a24fcbe3b93ba021a">00110</a>   <a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f1c79a00dd543cb06a24fcbe3b93ba021a">MDERR_OK</a>,
<a name="l00111"></a><a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f1207f5f4e7a3cc83a53aac435cdd8de4f">00111</a>   <a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f1207f5f4e7a3cc83a53aac435cdd8de4f">MDERR_MISSING</a>,
<a name="l00112"></a><a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f1295c23a32864bf1d2718a3bd7e251436">00112</a>   <a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f1295c23a32864bf1d2718a3bd7e251436">MDERR_EXISTS</a>,
<a name="l00113"></a><a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f139ffec0b21e1d76bf8dd52843ca5ca89">00113</a>   <a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f139ffec0b21e1d76bf8dd52843ca5ca89">MDERR_CONFLICT</a>,
<a name="l00114"></a><a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f19169462d9894b4466d4971322df21be0">00114</a>   <a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f19169462d9894b4466d4971322df21be0">MDERR_NOTREADY</a>,
<a name="l00115"></a><a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f1d1a1b27c7e2f09658db719e93df21b6f">00115</a>   <a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f1d1a1b27c7e2f09658db719e93df21b6f">MDERR_SYNTAX</a>,
<a name="l00116"></a><a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f13b274ec5c9c0fbad6d99e557716e5c36">00116</a>   <a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f13b274ec5c9c0fbad6d99e557716e5c36">N_MDSTDERR</a>
<a name="l00117"></a>00117 };
<a name="l00118"></a>00118 
<a name="l00119"></a><a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea">00119</a> <span class="keyword">enum</span> <a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea">md_dispatch_category</a> {
<a name="l00120"></a><a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea54ed2f4b5b1a84f7be94479fff63a765">00120</a>   <a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea54ed2f4b5b1a84f7be94479fff63a765">MD_NEWBORN</a>   = 0,                  <span class="comment">// inbound this isn't dispatched</span>
<a name="l00121"></a><a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea7849785955efbb3b00617b45ff4aa116">00121</a>   <a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea7849785955efbb3b00617b45ff4aa116">CD_FRAME</a>,
<a name="l00122"></a><a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea7745452175b61de3250cf35653f5a384">00122</a>   <a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea7745452175b61de3250cf35653f5a384">MD_FRAME</a>,
<a name="l00123"></a><a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9beab0515454bbd604d93e8918db7ec16839">00123</a>   <a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9beab0515454bbd604d93e8918db7ec16839">DV_MDQUERY</a>,
<a name="l00124"></a><a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea0ea8ed51a1c9e11103938d648aa01114">00124</a>    <a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea0ea8ed51a1c9e11103938d648aa01114">DVMDQ_REGSCPI</a>,
<a name="l00125"></a><a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea23753f9e69207e1b04d0566bfcdf9c66">00125</a>    <a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea23753f9e69207e1b04d0566bfcdf9c66">DVMDQ_REGOBS</a>,
<a name="l00126"></a><a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9beab01e2c523814c9b117e6aa01499ca2f9">00126</a>    <a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9beab01e2c523814c9b117e6aa01499ca2f9">DVMDQ_REGODE</a>,
<a name="l00127"></a><a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9beafa51e4d94e6b310ba4e3a0c39ce11155">00127</a>   <a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9beafa51e4d94e6b310ba4e3a0c39ce11155">MD_SHUTDOWN</a>
<a name="l00128"></a>00128 };
<a name="l00129"></a>00129 
<a name="l00130"></a><a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f051">00130</a> <span class="keyword">enum</span> <a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f051">md_device</a> {
<a name="l00131"></a><a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f051bf4d8240a241e6269220d0e9a1c264a0">00131</a>   <a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f051bf4d8240a241e6269220d0e9a1c264a0">MDDEV_MD</a> = 0,
<a name="l00132"></a><a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f0515351145f8fdbbddafe9e04f973b19f20">00132</a>   <a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f0515351145f8fdbbddafe9e04f973b19f20">MDDEV_CD</a>,
<a name="l00133"></a><a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f051df02ded475565758943c5d421224efec">00133</a>   <a class="code" href="mdconstants_8h.html#2c86c8bb56303a4af74ca6fb633804b7">MACHINE</a>,
<a name="l00134"></a><a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f051819dc86817b7bfe7aa56be65499ab8f4">00134</a>   <a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f051819dc86817b7bfe7aa56be65499ab8f4">MDDEV_INSTRUMENT</a>,
<a name="l00135"></a><a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f051e32cafa1b5e1779bb49c2824561a4c87">00135</a>   <a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f051e32cafa1b5e1779bb49c2824561a4c87">MDDEV_DATACLIENT</a>,
<a name="l00136"></a><a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f05198da71b6c1c2722207f905b7dfb80cdf">00136</a>   <a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f05198da71b6c1c2722207f905b7dfb80cdf">N_MDDEV_TYPES</a>
<a name="l00137"></a>00137 };
<a name="l00138"></a>00138 
<a name="l00139"></a><a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece">00139</a> <span class="keyword">enum</span> <a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece">md_units</a> {
<a name="l00140"></a><a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece6fcbcb0db7cecd25727dbf4ee74a760a">00140</a>   <a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece6fcbcb0db7cecd25727dbf4ee74a760a">MD_UNITS_UNDEFINED</a> = 0,
<a name="l00141"></a><a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567eced74faba3f23e31bb0e898c416d4edecc">00141</a>   <a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567eced74faba3f23e31bb0e898c416d4edecc">MD_CENTIMETERS</a>,  
<a name="l00142"></a><a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece32a8bff83d11e890e2f51a25afed7052">00142</a>   <a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece32a8bff83d11e890e2f51a25afed7052">MD_MILLIMETERS</a>,
<a name="l00143"></a><a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ecee2add16f5d9c1e3b0002710bacd586b7">00143</a>   <a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ecee2add16f5d9c1e3b0002710bacd586b7">MD_MICRONS</a>,
<a name="l00144"></a><a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece6a7370d754952d07f161e62e6fee2b03">00144</a>   <a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece6a7370d754952d07f161e62e6fee2b03">MD_NANOMETERS</a>,
<a name="l00145"></a><a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece67456ab2ed209331206220fc21a64477">00145</a>   <a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece67456ab2ed209331206220fc21a64477">MD_VOLTS</a>,
<a name="l00146"></a><a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece89cf31bbb109ea98dd1b1d13a36d6659">00146</a>   <a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece89cf31bbb109ea98dd1b1d13a36d6659">MD_CC</a>,
<a name="l00147"></a><a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece45cb897120a5cfc2bde544a419105294">00147</a>   <a class="code" href="mdcommon_8h.html#196b781434beeac48cb7e4f5f8567ece45cb897120a5cfc2bde544a419105294">N_MD_UNITS</a>
<a name="l00148"></a>00148 };
<a name="l00149"></a>00149 
<a name="l00150"></a><a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd">00150</a> <span class="keyword">enum</span> <a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd">mdDGtype</a> {
<a name="l00151"></a><a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd86127cad15ac8c4e3eac216900bf0516">00151</a>   <a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd86127cad15ac8c4e3eac216900bf0516">MDDG_HEARTBEAT</a> = 0,
<a name="l00152"></a><a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd05282a35026b731d6427ea2fd7cf3b97">00152</a>   <a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd05282a35026b731d6427ea2fd7cf3b97">MDDG_DEVICEHB</a>,
<a name="l00153"></a><a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd7309620eb261de5bb5cec282b0b78b52">00153</a>   <a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd7309620eb261de5bb5cec282b0b78b52">MDDG_NEWBORN</a>,
<a name="l00154"></a><a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd16426520294c565b9ac1ef453643d16c">00154</a>   <a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd16426520294c565b9ac1ef453643d16c">MDDG_MDQUERY</a>,
<a name="l00155"></a><a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd313d9a531a6ac7971d9408d9ace08526">00155</a>    <a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd313d9a531a6ac7971d9408d9ace08526">MDDG_REGSCPI</a>,
<a name="l00156"></a><a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddde383f96c612a9903b6cb2869d0c3a575">00156</a>    <a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddde383f96c612a9903b6cb2869d0c3a575">MDDG_REGOBS</a>,
<a name="l00157"></a><a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd2b95ed0adf749ed643904e9976170548">00157</a>    <a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd2b95ed0adf749ed643904e9976170548">MDDG_REGODE</a>,
<a name="l00158"></a><a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddedddd850e77769880018ada0f4b3b7796e1f">00158</a>   <a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddedddd850e77769880018ada0f4b3b7796e1f">MDDG_TELEMETRY</a>,
<a name="l00159"></a><a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd64318ee48547f9fe8e8bde99cfff5261">00159</a>   <a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd64318ee48547f9fe8e8bde99cfff5261">MDDG_CDRESET</a>,
<a name="l00160"></a><a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddedddcf6954f4b921a9a0abc62a99e274add9">00160</a>   <a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddedddcf6954f4b921a9a0abc62a99e274add9">N_MDDG_TYPES</a>
<a name="l00161"></a>00161 };
<a name="l00162"></a>00162 
<a name="l00163"></a><a class="code" href="structMD__DG__TYPE.html">00163</a> <span class="keyword">typedef</span>
<a name="l00164"></a>00164 <span class="keyword">struct </span><a class="code" href="structMD__DG__TYPE.html">MD_DG_TYPE</a> {
<a name="l00165"></a><a class="code" href="structMD__DG__TYPE.html#46aa2e45871cb79ba8511ccac113544e">00165</a> <span class="keywordtype">unsigned</span> <a class="code" href="structMD__DG__TYPE.html#46aa2e45871cb79ba8511ccac113544e">inBandOnly</a>   :  1;
<a name="l00166"></a><a class="code" href="structMD__DG__TYPE.html#65ae8fa3343299eb78fdf4940be4383b">00166</a> <span class="keywordtype">unsigned</span> <a class="code" href="structMD__DG__TYPE.html#65ae8fa3343299eb78fdf4940be4383b">requiresAck</a>  :  1;
<a name="l00167"></a><a class="code" href="structMD__DG__TYPE.html#9f7d5ef04cf8b7109203df4ddb883871">00167</a> <span class="keywordtype">unsigned</span> <a class="code" href="structMD__DG__TYPE.html#9f7d5ef04cf8b7109203df4ddb883871">isAckNak</a>     :  1;
<a name="l00168"></a><a class="code" href="structMD__DG__TYPE.html#b82a8937d241682c2a5e6d2305b8ee44">00168</a> <span class="keywordtype">unsigned</span> <a class="code" href="structMD__DG__TYPE.html#b82a8937d241682c2a5e6d2305b8ee44">value</a>        :  1; <span class="comment">// i.e. boolean for ack/nak etc. where true = ack.</span>
<a name="l00169"></a><a class="code" href="structMD__DG__TYPE.html#36f8da3edd0b811c7ab738b26a6aaed8">00169</a> <span class="keywordtype">unsigned</span> <a class="code" href="structMD__DG__TYPE.html#36f8da3edd0b811c7ab738b26a6aaed8">reserved</a>     :  4;
<a name="l00170"></a><a class="code" href="structMD__DG__TYPE.html#08a2fc368be71ed72cb499ac4ef4ae2e">00170</a> <span class="keywordtype">unsigned</span> <a class="code" href="structMD__DG__TYPE.html#08a2fc368be71ed72cb499ac4ef4ae2e">clieverGroup</a> :  8; <span class="comment">// masterDaemonConfig.thisMachineContext</span>
<a name="l00171"></a><a class="code" href="structMD__DG__TYPE.html#3c8f4f950b5d8c41ee9af7f8c49476bf">00171</a> <span class="keywordtype">unsigned</span> <a class="code" href="structMD__DG__TYPE.html#3c8f4f950b5d8c41ee9af7f8c49476bf">reserved2</a>    : 16; 
<a name="l00172"></a>00172 }
<a name="l00173"></a>00173  <a class="code" href="structMD__DG__TYPE.html">mdDGflags</a>;
<a name="l00174"></a>00174 
<a name="l00175"></a><a class="code" href="structMD__DG__HEADER.html">00175</a> <span class="keyword">typedef</span> 
<a name="l00176"></a>00176 <span class="keyword">struct </span><a class="code" href="structMD__DG__HEADER.html">MD_DG_HEADER</a> {
<a name="l00177"></a><a class="code" href="structMD__DG__HEADER.html#3cb6c3556b439831eed1d76592765f2f">00177</a> <a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd">mdDGtype</a>    <a class="code" href="structMD__DG__HEADER.html#3cb6c3556b439831eed1d76592765f2f">msgType</a>;
<a name="l00178"></a><a class="code" href="structMD__DG__HEADER.html#0018718733130a6c766e25e8e27e36bf">00178</a> <a class="code" href="structMD__DG__TYPE.html">mdDGflags</a>   <a class="code" href="structMD__DG__HEADER.html#0018718733130a6c766e25e8e27e36bf">dgType</a>;
<a name="l00179"></a><a class="code" href="structMD__DG__HEADER.html#fa53139e16132a86b0055ebfb705c291">00179</a> <a class="code" href="mdcommon_8h.html#fcc5cc24102ccd9a8e45227ea5ddeddd">mdDGtype</a>    <a class="code" href="structMD__DG__HEADER.html#fa53139e16132a86b0055ebfb705c291">dgSubType</a>;
<a name="l00180"></a><a class="code" href="structMD__DG__HEADER.html#6b9fcc7785fdf3f7d186ecb03eaefade">00180</a> <span class="keywordtype">int</span>         <a class="code" href="structMD__DG__HEADER.html#6b9fcc7785fdf3f7d186ecb03eaefade">msgSN</a>;           <span class="comment">// Ordinal in a dialog </span>
<a name="l00181"></a><a class="code" href="structMD__DG__HEADER.html#a7cd3af7afe45e124347714bca642f17">00181</a> <a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f051">md_device</a>   <a class="code" href="structMD__DG__HEADER.html#a7cd3af7afe45e124347714bca642f17">clientType</a>;
<a name="l00182"></a><a class="code" href="structMD__DG__HEADER.html#22c2014a5093cfe50a41ff548b889e5d">00182</a> <span class="keywordtype">int</span>         <a class="code" href="structMD__DG__HEADER.html#22c2014a5093cfe50a41ff548b889e5d">sourceHandle</a>;
<a name="l00183"></a><a class="code" href="structMD__DG__HEADER.html#7baad8f89009478f1ef5b99df69d63b8">00183</a> <span class="keywordtype">int</span>         <a class="code" href="structMD__DG__HEADER.html#7baad8f89009478f1ef5b99df69d63b8">sinkHandle</a>;
<a name="l00184"></a><a class="code" href="structMD__DG__HEADER.html#bbaa18fe526725a0469dde6e69d5e411">00184</a> <span class="keywordtype">int</span>         <a class="code" href="structMD__DG__HEADER.html#bbaa18fe526725a0469dde6e69d5e411">handle</a>;          <span class="comment">// for example if query about a device other than source or sink.</span>
<a name="l00185"></a><a class="code" href="structMD__DG__HEADER.html#67b07766585ef17cc7d6b2c1ed295e41">00185</a> <a class="code" href="mdcommon_8h.html#f41f2d8225778639c98f4ac8c036d2f1">mdErrorCode</a> <a class="code" href="structMD__DG__HEADER.html#67b07766585ef17cc7d6b2c1ed295e41">ec</a>;
<a name="l00186"></a><a class="code" href="structMD__DG__HEADER.html#6947aef60794553c98b4fe7e7e5a68f2">00186</a> <span class="keywordtype">int</span>         <a class="code" href="structMD__DG__HEADER.html#6947aef60794553c98b4fe7e7e5a68f2">payloadSize</a>;
<a name="l00187"></a><a class="code" href="structMD__DG__HEADER.html#ec7816214d8123e54b9e1761d915bc8a">00187</a> <span class="keywordtype">int</span>         <a class="code" href="structMD__DG__HEADER.html#ec7816214d8123e54b9e1761d915bc8a">primeOffset</a>;     <span class="comment">// for example to the name associated with the data</span>
<a name="l00188"></a>00188 }
<a name="l00189"></a>00189  <a class="code" href="structMD__DG__HEADER.html">mdDGHeader</a>;
<a name="l00190"></a>00190 
<a name="l00191"></a><a class="code" href="structMD__DATAGRAM.html">00191</a> <span class="keyword">typedef</span>
<a name="l00192"></a>00192 <span class="keyword">struct </span><a class="code" href="structMD__DATAGRAM.html">MD_DATAGRAM</a> {
<a name="l00193"></a><a class="code" href="structMD__DATAGRAM.html#291a1d2fb7d929c19670d021e6626401">00193</a>   <a class="code" href="structMD__DG__HEADER.html">mdDGHeader</a> <a class="code" href="structMD__DATAGRAM.html#291a1d2fb7d929c19670d021e6626401">hdr</a>;
<a name="l00194"></a><a class="code" href="structMD__DATAGRAM.html#3364f693abdd6e187306374f33d5f9bf">00194</a>   <span class="keywordtype">char</span>       <a class="code" href="structMD__DATAGRAM.html#3364f693abdd6e187306374f33d5f9bf">payLoad</a>[<a class="code" href="mdconstants_8h.html#ce031863fe2e2559d0ed2f3f4e2d102f">MD_MAX_DATAGRAM</a> - (<span class="keyword">sizeof</span>(<a class="code" href="structMD__DG__HEADER.html">mdDGHeader</a>))];
<a name="l00195"></a>00195 }
<a name="l00196"></a>00196  <a class="code" href="structMD__DATAGRAM.html">mdDatagram</a>;
<a name="l00197"></a>00197 
<a name="l00198"></a><a class="code" href="structMD__REPLY.html">00198</a> <span class="keyword">typedef</span> 
<a name="l00199"></a>00199 <span class="keyword">struct </span><a class="code" href="structMD__REPLY.html">MD_REPLY</a> {
<a name="l00200"></a><a class="code" href="structMD__REPLY.html#fc764fc587aba8c46f551e76fb5852f9">00200</a>  <a class="code" href="structMD__DG__HEADER.html">mdDGHeader</a> <a class="code" href="structMD__REPLY.html#fc764fc587aba8c46f551e76fb5852f9">hdr</a>;
<a name="l00201"></a><a class="code" href="structMD__REPLY.html#93d7f0cb57073fae007a1c2513995cc4">00201</a>  <span class="keywordtype">char</span>  <a class="code" href="structMD__REPLY.html#93d7f0cb57073fae007a1c2513995cc4">payLoad</a>[512 - <span class="keyword">sizeof</span>(<a class="code" href="structMD__DG__HEADER.html">mdDGHeader</a>)];
<a name="l00202"></a>00202 }
<a name="l00203"></a>00203  <a class="code" href="structMD__REPLY.html">mdDGReply</a>;
<a name="l00204"></a>00204 
<a name="l00205"></a><a class="code" href="classmdReply.html">00205</a> <span class="keyword">class </span><a class="code" href="classmdReply.html">mdReply</a> {
<a name="l00206"></a>00206 <span class="keyword">public</span>:
<a name="l00207"></a>00207 
<a name="l00208"></a><a class="code" href="classmdReply.html#4411d5f27fca1e3b1414963b682c350a">00208</a>  <a class="code" href="structMD__REPLY.html">mdDGReply</a>  <a class="code" href="classmdReply.html#4411d5f27fca1e3b1414963b682c350a">dg</a>;
<a name="l00209"></a>00209 
<a name="l00210"></a><a class="code" href="classmdReply.html#b7c0483674fce5eb44872b92ed1be20b">00210</a>  <a class="code" href="classmdReply.html#b7c0483674fce5eb44872b92ed1be20b">mdReply</a>() {memset((<span class="keywordtype">void</span> *)&amp;<a class="code" href="classmdReply.html#4411d5f27fca1e3b1414963b682c350a">dg</a>,0,<span class="keyword">sizeof</span>(<a class="code" href="structMD__REPLY.html">mdDGReply</a>));
<a name="l00211"></a>00211             dg.hdr.dgType.isAckNak = <span class="keyword">true</span>;
<a name="l00212"></a>00212            }
<a name="l00213"></a>00213 };
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 <span class="preprocessor">#if (defined(MD_MAIN) || defined(CD_MAIN) || defined(DV_MAIN) || defined(DV_DLL_MAIN))</span>
<a name="l00216"></a><a class="code" href="mdcommon_8h.html#32160553a9bfa2db35e57fbfb3a3ab75">00216</a> <span class="preprocessor"></span><span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdcommon_8h.html#32160553a9bfa2db35e57fbfb3a3ab75">clientTypes</a>[<a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f05198da71b6c1c2722207f905b7dfb80cdf">N_MDDEV_TYPES</a> ] = { <span class="stringliteral">"Master Daemon"</span>,  <span class="stringliteral">"Cliever"</span>, <span class="stringliteral">"Machine"</span>, <span class="stringliteral">"Instrument"</span>, <span class="stringliteral">"MD Non-Data Client"</span> };
<a name="l00217"></a>00217 <span class="preprocessor">#else</span>
<a name="l00218"></a>00218 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="mdcommon_8h.html#32160553a9bfa2db35e57fbfb3a3ab75">clientTypes</a>[<a class="code" href="mdcommon_8h.html#c35fad87271883ee60c7393bc6e5f05198da71b6c1c2722207f905b7dfb80cdf">N_MDDEV_TYPES</a>];
<a name="l00219"></a>00219 <span class="preprocessor">#endif</span>
<a name="l00220"></a>00220 <span class="preprocessor"></span>
<a name="l00221"></a>00221 <span class="comment">/* \brief mdProcess</span>
<a name="l00222"></a>00222 <span class="comment"> *        Abstract base class of various subprocesses</span>
<a name="l00223"></a>00223 <span class="comment"> *</span>
<a name="l00224"></a>00224 <span class="comment"> *  DACLIPS is a distributed system with various subprocesses</span>
<a name="l00225"></a>00225 <span class="comment"> *  spanning the central server, the 'Cliever' middleware component and clients.</span>
<a name="l00226"></a>00226 <span class="comment"> *  Root class for these.</span>
<a name="l00227"></a>00227 <span class="comment"> *</span>
<a name="l00228"></a>00228 <span class="comment"> */</span>
<a name="l00229"></a>00229 
<a name="l00230"></a><a class="code" href="classmdWQitem.html">00230</a> <span class="keyword">class </span><a class="code" href="classmdWQitem.html">mdWQitem</a> {
<a name="l00231"></a>00231 <span class="keyword">public</span>:
<a name="l00232"></a><a class="code" href="classmdWQitem.html#41a2daa2e59356f795030fcf88f4d184">00232</a>  <a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea">md_dispatch_category</a> <a class="code" href="classmdWQitem.html#41a2daa2e59356f795030fcf88f4d184">kind</a>;
<a name="l00233"></a><a class="code" href="classmdWQitem.html#7480e8df99dac328118b5475e7608a1e">00233</a>  <span class="keyword">const</span> <span class="keywordtype">void</span>          *<a class="code" href="classmdWQitem.html#7480e8df99dac328118b5475e7608a1e">what</a>;
<a name="l00234"></a><a class="code" href="classmdWQitem.html#500c212a1105d77dacd5c0a2f27504fe">00234</a>  <span class="keywordtype">int</span>                  <a class="code" href="classmdWQitem.html#500c212a1105d77dacd5c0a2f27504fe">user</a>; <span class="comment">// User defined</span>
<a name="l00235"></a><a class="code" href="classmdWQitem.html#e25294c4d3447c823e20b3f743cc7c6c">00235</a>  <a class="code" href="classmdWQitem.html#e25294c4d3447c823e20b3f743cc7c6c">mdWQitem</a> (<span class="keyword">const</span> <span class="keywordtype">void</span> *work,<a class="code" href="mdcommon_8h.html#d86b26f9d703681a467a3d461e2c9bea">md_dispatch_category</a> priority,<span class="keywordtype">int</span> x)
<a name="l00236"></a>00236  : <a class="code" href="classmdWQitem.html#7480e8df99dac328118b5475e7608a1e">what</a>(work), <a class="code" href="classmdWQitem.html#41a2daa2e59356f795030fcf88f4d184">kind</a>(priority), <a class="code" href="classmdWQitem.html#500c212a1105d77dacd5c0a2f27504fe">user</a>(x) {}
<a name="l00237"></a>00237  
<a name="l00238"></a><a class="code" href="classmdWQitem.html#06e0150b77c7ea85959e1839fb2378eb">00238</a>  <span class="keywordtype">bool</span> <a class="code" href="classmdWQitem.html#06e0150b77c7ea85959e1839fb2378eb">operator&lt; </a>(<span class="keyword">const</span> <a class="code" href="classmdWQitem.html">mdWQitem</a> &amp; right)<span class="keyword"> const </span>{
<a name="l00239"></a>00239   <span class="keywordflow">return</span> <a class="code" href="classmdWQitem.html#41a2daa2e59356f795030fcf88f4d184">kind</a> &lt; right.<a class="code" href="classmdWQitem.html#41a2daa2e59356f795030fcf88f4d184">kind</a>; 
<a name="l00240"></a>00240  }
<a name="l00241"></a>00241 
<a name="l00242"></a>00242 };
<a name="l00243"></a>00243 
<a name="l00244"></a><a class="code" href="mdcommon_8h.html#15634831091224a783acda8e672bd736">00244</a> <span class="keyword">typedef</span> std::priority_queue &lt; mdWQitem* &gt; <a class="code" href="mdcommon_8h.html#15634831091224a783acda8e672bd736">MDWQ</a>;
<a name="l00245"></a>00245 
<a name="l00246"></a><a class="code" href="classmdProcess.html">00246</a> <span class="keyword">class </span><a class="code" href="classmdProcess.html">mdProcess</a> {  
<a name="l00247"></a><a class="code" href="classmdProcess.html#1d83bc66116d959fd759d3353160f69c">00247</a> <span class="keyword">public</span>: <a class="code" href="mdcommon_8h.html#15634831091224a783acda8e672bd736">MDWQ</a> <a class="code" href="classmdProcess.html#1d83bc66116d959fd759d3353160f69c">q</a>;
<a name="l00248"></a><a class="code" href="classmdProcess.html#15687c9aec3d6421661681f470f13008">00248</a>                    <a class="code" href="classmdProcess.html#15687c9aec3d6421661681f470f13008">mdProcess</a>()  {}
<a name="l00249"></a><a class="code" href="classmdProcess.html#bb3f78f6cd667edfba86e23ed7aa6391">00249</a>                   <a class="code" href="classmdProcess.html#bb3f78f6cd667edfba86e23ed7aa6391">~mdProcess</a>()  {}
<a name="l00250"></a>00250 
<a name="l00251"></a><a class="code" href="classmdProcess.html#925fa09d5012ab9b78751362b27fe53d">00251</a>         <span class="keywordtype">void</span>  <a class="code" href="classmdProcess.html#925fa09d5012ab9b78751362b27fe53d">queue</a>(<a class="code" href="classmdWQitem.html">mdWQitem</a> *w) {<a class="code" href="classmdProcess.html#1d83bc66116d959fd759d3353160f69c">q</a>.push(w);}             
<a name="l00252"></a>00252 <span class="keyword">virtual</span> <span class="keywordtype">void</span>  <a class="code" href="classmdProcess.html#bf8c1652ad86913530ef1c19542cc873">dispatch</a>(<a class="code" href="classmdWQitem.html">mdWQitem</a> *w)=0;
<a name="l00253"></a>00253 <span class="keyword">virtual</span> <span class="keywordtype">void</span>  <a class="code" href="classmdProcess.html#cdbfbffb9fe59fc59e42c91588f8938d">run</a>() = 0;  
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 };
<a name="l00256"></a>00256 <span class="preprocessor">#define MD_DEFAULT_DEVICE_PROTOCOL 0</span>
<a name="l00257"></a>00257 <span class="preprocessor"></span><span class="preprocessor">#define MD_DEFAULT_RULE            0</span>
<a name="l00258"></a>00258 <span class="preprocessor"></span>
<a name="l00259"></a><a class="code" href="structmdCnctBool.html">00259</a> <span class="keyword">typedef</span>
<a name="l00260"></a>00260 <span class="keyword">struct </span>{ 
<a name="l00261"></a><a class="code" href="structmdCnctBool.html#97f1382d695405c17100c8a33cc79a68">00261</a>   <span class="keywordtype">unsigned</span>       open:1;  
<a name="l00262"></a><a class="code" href="structmdCnctBool.html#67dcf1e3261727614d1b2283a85aa9fd">00262</a>   <span class="keywordtype">unsigned</span>     looped:1;  <span class="comment">// back channel established from passive connection.     </span>
<a name="l00263"></a><a class="code" href="structmdCnctBool.html#bf9319a38d50b49e3537bcf8ebda15c9">00263</a>   <span class="keywordtype">unsigned</span>  reserved:30;
<a name="l00264"></a>00264  } <a class="code" href="structmdCnctBool.html">mdCnctBool</a>;
<a name="l00265"></a>00265 
<a name="l00266"></a><a class="code" href="structMD__CONTROL__BLOCK.html">00266</a> <span class="keyword">typedef</span> 
<a name="l00267"></a>00267 <span class="keyword">struct  </span><a class="code" href="structMD__CONTROL__BLOCK.html">MD_CONTROL_BLOCK</a>
<a name="l00268"></a><a class="code" href="structMD__CONTROL__BLOCK.html#f500ac62783123ee75aba939d4235295">00268</a> {<span class="keywordtype">int</span>                                  <a class="code" href="structMD__CONTROL__BLOCK.html#f500ac62783123ee75aba939d4235295">handle</a>;        <span class="comment">// debug mark</span>
<a name="l00269"></a><a class="code" href="structMD__CONTROL__BLOCK.html#767a3895bb4087ce5475dc684dadf00a">00269</a>  <a class="code" href="structmdCnctBool.html">mdCnctBool</a>                       <a class="code" href="structMD__CONTROL__BLOCK.html#767a3895bb4087ce5475dc684dadf00a">connection</a>;
<a name="l00270"></a><a class="code" href="structMD__CONTROL__BLOCK.html#944e3bac46ffab5bfd6fa1938103e28c">00270</a>  boost::asio::ip::udp::endpoint           <a class="code" href="structMD__CONTROL__BLOCK.html#944e3bac46ffab5bfd6fa1938103e28c">ep</a>;
<a name="l00271"></a><a class="code" href="structMD__CONTROL__BLOCK.html#8e4c9d0fd58354f8ba8d6096c4777be9">00271</a>  boost::asio::ip::udp::resolver::iterator <a class="code" href="structMD__CONTROL__BLOCK.html#8e4c9d0fd58354f8ba8d6096c4777be9">it</a>;
<a name="l00272"></a><a class="code" href="structMD__CONTROL__BLOCK.html#56adc0da4c5d17fd9d647390efe12b74">00272</a>  <a class="code" href="lxi-control_8c.html#3666576f6b88007cc7b8f26c7da596c8">boost::asio::ip::udp::socket</a>           *<a class="code" href="structMD__CONTROL__BLOCK.html#56adc0da4c5d17fd9d647390efe12b74">udp</a>;
<a name="l00273"></a><a class="code" href="structMD__CONTROL__BLOCK.html#b263dc8dc7a26484c3dc29527e34ad81">00273</a>  <a class="code" href="structMD__CONTROL__BLOCK.html#b263dc8dc7a26484c3dc29527e34ad81">MD_CONTROL_BLOCK</a>() {
<a name="l00274"></a>00274   <a class="code" href="structMD__CONTROL__BLOCK.html#f500ac62783123ee75aba939d4235295">handle</a> = 0;
<a name="l00275"></a>00275   memset((<span class="keywordtype">void</span> *)&amp;<a class="code" href="structMD__CONTROL__BLOCK.html#767a3895bb4087ce5475dc684dadf00a">connection</a>,0,<span class="keyword">sizeof</span>(connection));
<a name="l00276"></a>00276   <a class="code" href="structMD__CONTROL__BLOCK.html#56adc0da4c5d17fd9d647390efe12b74">udp</a>    = NULL;
<a name="l00277"></a>00277  }
<a name="l00278"></a>00278 }
<a name="l00279"></a>00279  <a class="code" href="structMD__CONTROL__BLOCK.html">mdCB</a>;
<a name="l00280"></a>00280 
<a name="l00281"></a><a class="code" href="mdcommon_8h.html#bec3df68ff78e98f4718fa9528ed88e7">00281</a> <span class="keyword">typedef</span> std::map&lt;int,mdCB*&gt; <a class="code" href="mdcommon_8h.html#bec3df68ff78e98f4718fa9528ed88e7">mdStdDevicePODMap</a>;      <span class="comment">// MD Standard Device Map -</span>
<a name="l00282"></a>00282 <span class="comment">/*</span>
<a name="l00283"></a>00283 <span class="comment"> *\brief stdDev: collection with       MD at: 0, CD in:  1 - MAX_CLIEVER,</span>
<a name="l00284"></a>00284 <span class="comment"> *                                      MACHINEs    in:  MAX_CLIEVER+1    - MAX_CLIEVER*2,</span>
<a name="l00285"></a>00285 <span class="comment"> *                                      Instruments in: (MAX_CLIEVER*2)+1 - (((MAX_CLIEVER*2)+1)+(MAX_CLIEVER*MAX_INSTRUMENTS)),</span>
<a name="l00286"></a>00286 <span class="comment"> *                                      DataClients in: (MAX_CLIEVER*MAX_INSTRUMENTS)+1 - MAX_CLIENT</span>
<a name="l00287"></a>00287 <span class="comment"> *                                     localhost    at:  MAX_CLIENT+1</span>
<a name="l00288"></a>00288 <span class="comment"> * </span>
<a name="l00289"></a>00289 <span class="comment"> * The mdStdDevIdx of a device is its index above. </span>
<a name="l00290"></a>00290 <span class="comment"> * Within intervals clients are assigned compactly in the same order as thier handles are created and assigned.</span>
<a name="l00291"></a>00291 <span class="comment"> */</span>
<a name="l00292"></a>00292 
<a name="l00293"></a>00293 <span class="preprocessor">#if (defined(MD_MAIN) || defined(CD_MAIN) || defined(DV_DLL_MAIN))</span>
<a name="l00294"></a><a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">00294</a> <span class="preprocessor"></span>         <a class="code" href="mdcommon_8h.html#bec3df68ff78e98f4718fa9528ed88e7">mdStdDevicePODMap</a>  <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>;
<a name="l00295"></a><a class="code" href="mdcommon_8h.html#c8287275fac7647c0c3862d365d35137">00295</a>          <span class="keywordtype">int</span>                <a class="code" href="mdcommon_8h.html#c8287275fac7647c0c3862d365d35137">myStdDevIdx</a>=MAX_CLIENTS+1; <span class="comment">// global default to localhost</span>
<a name="l00296"></a>00296 <span class="preprocessor">#else</span>
<a name="l00297"></a>00297 <span class="preprocessor"></span>  <span class="keyword">extern</span> <a class="code" href="mdcommon_8h.html#bec3df68ff78e98f4718fa9528ed88e7">mdStdDevicePODMap</a>  <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>;
<a name="l00298"></a>00298   <span class="keyword">extern</span> <span class="keywordtype">int</span>                <a class="code" href="mdcommon_8h.html#c8287275fac7647c0c3862d365d35137">myStdDevIdx</a>;
<a name="l00299"></a>00299 <span class="preprocessor">#endif</span>
<a name="l00300"></a>00300 <span class="preprocessor"></span>
<a name="l00301"></a><a class="code" href="classmdDGChannel.html">00301</a> <span class="keyword">class </span><a class="code" href="classmdDGChannel.html">mdDGChannel</a>
<a name="l00302"></a>00302 {<span class="keyword">public</span>:
<a name="l00303"></a>00303 
<a name="l00304"></a><a class="code" href="classmdDGChannel.html#f214d4fd5b41dde7b05539b3adf250c7">00304</a>   boost::asio::io_service&amp;                         <a class="code" href="classmdDGChannel.html#f214d4fd5b41dde7b05539b3adf250c7">io_service_</a>;
<a name="l00305"></a><a class="code" href="classmdDGChannel.html#358a408e77bc5d70bf5dc99595d636e6">00305</a>   boost::asio::ip::udp::endpoint                   <a class="code" href="classmdDGChannel.html#358a408e77bc5d70bf5dc99595d636e6">p_endpoint_</a>;
<a name="l00306"></a><a class="code" href="classmdDGChannel.html#4bef79f3fe5f96f3c0c545736bff9f74">00306</a>   boost::asio::ip::udp::endpoint                   <a class="code" href="classmdDGChannel.html#4bef79f3fe5f96f3c0c545736bff9f74">a_endpoint_</a>;
<a name="l00307"></a><a class="code" href="classmdDGChannel.html#708f1a4af55f7094c364dd75a91acaf5">00307</a>   boost::asio::ip::udp::endpoint                          *<a class="code" href="classmdDGChannel.html#708f1a4af55f7094c364dd75a91acaf5">ep_</a>;
<a name="l00308"></a><a class="code" href="classmdDGChannel.html#adb8f139da49b3d4a5d020334539f295">00308</a>   boost::asio::ip::udp::resolver                            *<a class="code" href="classmdDGChannel.html#adb8f139da49b3d4a5d020334539f295">r</a>;
<a name="l00309"></a><a class="code" href="classmdDGChannel.html#37aeacb7e13840b3a03c141cacae1c12">00309</a>   boost::asio::ip::udp::resolver::query                     *<a class="code" href="classmdDGChannel.html#37aeacb7e13840b3a03c141cacae1c12">q</a>;
<a name="l00310"></a><a class="code" href="classmdDGChannel.html#742843f16459d561ea5527be8a0d44f3">00310</a>   <a class="code" href="lxi-control_8c.html#3666576f6b88007cc7b8f26c7da596c8">boost::asio::ip::udp::socket</a>                        <a class="code" href="classmdDGChannel.html#742843f16459d561ea5527be8a0d44f3">passive_</a>;
<a name="l00311"></a><a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">00311</a>   <a class="code" href="lxi-control_8c.html#3666576f6b88007cc7b8f26c7da596c8">boost::asio::ip::udp::socket</a>                        *<a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>;
<a name="l00312"></a><a class="code" href="classmdDGChannel.html#77294931a0fdb80c9f4883d38abc5414">00312</a>   <a class="code" href="lxi-control_8c.html#3666576f6b88007cc7b8f26c7da596c8">boost::asio::ip::udp::socket</a>                             *<a class="code" href="classmdDGChannel.html#77294931a0fdb80c9f4883d38abc5414">s_</a>;
<a name="l00313"></a>00313   
<a name="l00314"></a><a class="code" href="classmdDGChannel.html#35a4d6bdea098e27c21fa91c02c2d20a">00314</a>   <span class="keywordtype">char</span>                                 <a class="code" href="classmdDGChannel.html#35a4d6bdea098e27c21fa91c02c2d20a">ack_</a>[<span class="keyword">sizeof</span>(<a class="code" href="structMD__REPLY.html">mdDGReply</a>)];
<a name="l00315"></a><a class="code" href="classmdDGChannel.html#fed9a3cbfbf85f8bf1b74bbbc25678c8">00315</a>   <span class="keywordtype">char</span>                                  <a class="code" href="classmdDGChannel.html#fed9a3cbfbf85f8bf1b74bbbc25678c8">data_</a>[<a class="code" href="mdconstants_8h.html#ce031863fe2e2559d0ed2f3f4e2d102f">MD_MAX_DATAGRAM</a>];
<a name="l00316"></a>00316 
<a name="l00317"></a><a class="code" href="classmdDGChannel.html#53722f0e0c46baae7dddc227af22ae68">00317</a>   <span class="keywordtype">int</span>                                              <a class="code" href="classmdDGChannel.html#53722f0e0c46baae7dddc227af22ae68">mdStdDevIdx</a>;
<a name="l00318"></a>00318 
<a name="l00319"></a><a class="code" href="classmdDGChannel.html#c498de123b8f1135ed0a168c9456069a">00319</a>   <a class="code" href="structMD__DATAGRAM.html">mdDatagram</a>                                        *<a class="code" href="classmdDGChannel.html#c498de123b8f1135ed0a168c9456069a">inProcess</a>;
<a name="l00320"></a><a class="code" href="classmdDGChannel.html#6ef20699910891f8eeee09c5dc94507c">00320</a>   <a class="code" href="classmdReply.html">mdReply</a>                                               *<a class="code" href="classmdDGChannel.html#6ef20699910891f8eeee09c5dc94507c">reply</a>;
<a name="l00321"></a>00321 
<a name="l00322"></a><a class="code" href="classmdDGChannel.html#c2d5c212169ca7b8b8eeef7b76432b37">00322</a>   <span class="keywordtype">short</span>                                                   <a class="code" href="classmdDGChannel.html#c2d5c212169ca7b8b8eeef7b76432b37">port</a>;
<a name="l00323"></a>00323 
<a name="l00324"></a><a class="code" href="classmdDGChannel.html#15afa65890d0303abd49b8b5b0b92520">00324</a>   <a class="code" href="classmdDGChannel.html#15afa65890d0303abd49b8b5b0b92520">mdDGChannel</a>(boost::asio::io_service&amp; io_service,
<a name="l00325"></a>00325               <span class="keywordtype">short</span> inport, <span class="keywordtype">int</span> stdDevIdx=<a class="code" href="mdcommon_8h.html#c8287275fac7647c0c3862d365d35137">myStdDevIdx</a>)
<a name="l00326"></a>00326     : <a class="code" href="classmdDGChannel.html#f214d4fd5b41dde7b05539b3adf250c7">io_service_</a>(io_service), <a class="code" href="classmdDGChannel.html#53722f0e0c46baae7dddc227af22ae68">mdStdDevIdx</a>(stdDevIdx), 
<a name="l00327"></a>00327       <a class="code" href="classmdDGChannel.html#742843f16459d561ea5527be8a0d44f3">passive_</a>(io_service, udp::endpoint(udp::v4(), inport))
<a name="l00328"></a>00328   {   
<a name="l00329"></a>00329    <a class="code" href="classmdDGChannel.html#c498de123b8f1135ed0a168c9456069a">inProcess</a>   = (<a class="code" href="structMD__DATAGRAM.html">mdDatagram</a> *)<a class="code" href="classmdDGChannel.html#fed9a3cbfbf85f8bf1b74bbbc25678c8">data_</a>;
<a name="l00330"></a>00330    <a class="code" href="classmdDGChannel.html#708f1a4af55f7094c364dd75a91acaf5">ep_</a>         = &amp;<a class="code" href="classmdDGChannel.html#358a408e77bc5d70bf5dc99595d636e6">p_endpoint_</a>;
<a name="l00331"></a>00331    <a class="code" href="classmdDGChannel.html#c2d5c212169ca7b8b8eeef7b76432b37">port</a>        = inport;
<a name="l00332"></a>00332    <a class="code" href="classmdDGChannel.html#6ef20699910891f8eeee09c5dc94507c">reply</a>       = (<a class="code" href="classmdReply.html">mdReply</a> *)<a class="code" href="classmdDGChannel.html#35a4d6bdea098e27c21fa91c02c2d20a">ack_</a>;
<a name="l00333"></a>00333    <a class="code" href="classmdDGChannel.html#37aeacb7e13840b3a03c141cacae1c12">q</a>           = NULL;
<a name="l00334"></a>00334    <a class="code" href="classmdDGChannel.html#adb8f139da49b3d4a5d020334539f295">r</a>           = NULL;
<a name="l00335"></a>00335    <a class="code" href="classmdDGChannel.html#77294931a0fdb80c9f4883d38abc5414">s_</a>          = &amp;<a class="code" href="classmdDGChannel.html#742843f16459d561ea5527be8a0d44f3">passive_</a>;
<a name="l00336"></a>00336    
<a name="l00337"></a>00337     <a class="code" href="classmdDGChannel.html#742843f16459d561ea5527be8a0d44f3">passive_</a>.async_receive_from(
<a name="l00338"></a>00338         boost::asio::buffer(<a class="code" href="classmdDGChannel.html#fed9a3cbfbf85f8bf1b74bbbc25678c8">data_</a>, <a class="code" href="mdconstants_8h.html#ce031863fe2e2559d0ed2f3f4e2d102f">MD_MAX_DATAGRAM</a>), <a class="code" href="classmdDGChannel.html#358a408e77bc5d70bf5dc99595d636e6">p_endpoint_</a>,
<a name="l00339"></a>00339         boost::bind(&amp;<a class="code" href="classmdDGChannel.html#061ed6e19546d4ea693e75862e00c57a">mdDGChannel::handle_receive_from</a>, <span class="keyword">this</span>,
<a name="l00340"></a>00340           boost::asio::placeholders::error,
<a name="l00341"></a>00341           boost::asio::placeholders::bytes_transferred));
<a name="l00342"></a>00342   }
<a name="l00343"></a>00343 
<a name="l00344"></a><a class="code" href="classmdDGChannel.html#c82c1016c8d821bc8e1e2996dd15748f">00344</a>   <span class="keywordtype">void</span> <a class="code" href="classmdDGChannel.html#c82c1016c8d821bc8e1e2996dd15748f">async_send</a>(<a class="code" href="structMD__DATAGRAM.html">mdDatagram</a> &amp;dg) {
<a name="l00345"></a>00345 
<a name="l00346"></a>00346       <span class="keywordtype">size_t</span> dgSize = <span class="keyword">sizeof</span>(<a class="code" href="structMD__DG__HEADER.html">mdDGHeader</a>) + dg.<a class="code" href="structMD__DATAGRAM.html#291a1d2fb7d929c19670d021e6626401">hdr</a>.<a class="code" href="structMD__DG__HEADER.html#6947aef60794553c98b4fe7e7e5a68f2">payloadSize</a>;
<a name="l00347"></a>00347 
<a name="l00348"></a>00348       *<a class="code" href="classmdDGChannel.html#c498de123b8f1135ed0a168c9456069a">inProcess</a> = dg;
<a name="l00349"></a>00349       <span class="comment">//std::memcpy(this-&gt;data_,(char *)&amp;dg,dgSize);</span>
<a name="l00350"></a>00350 
<a name="l00351"></a>00351       <a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>-&gt;async_send_to(
<a name="l00352"></a>00352           boost::asio::buffer(<a class="code" href="classmdDGChannel.html#fed9a3cbfbf85f8bf1b74bbbc25678c8">data_</a>, dgSize), *<a class="code" href="classmdDGChannel.html#708f1a4af55f7094c364dd75a91acaf5">ep_</a>,
<a name="l00353"></a>00353           boost::bind(&amp;<a class="code" href="classmdDGChannel.html#cecc96101c84895f91a24338b81e6618">mdDGChannel::handle_send_to</a>, <span class="keyword">this</span>,
<a name="l00354"></a>00354             boost::asio::placeholders::error,
<a name="l00355"></a>00355             boost::asio::placeholders::bytes_transferred));
<a name="l00356"></a>00356    }
<a name="l00357"></a>00357 
<a name="l00358"></a><a class="code" href="classmdDGChannel.html#0ddcb3989f4b2035bb39f0e1d372945b">00358</a>    <span class="keywordtype">bool</span> <a class="code" href="classmdDGChannel.html#0ddcb3989f4b2035bb39f0e1d372945b">connect_to</a> (std::string &amp;host, std::string &amp;<a class="code" href="classmdDGChannel.html#c2d5c212169ca7b8b8eeef7b76432b37">port</a>, <span class="keywordtype">int</span> stdDevIdx=-1) {
<a name="l00359"></a>00359 
<a name="l00360"></a>00360    <span class="keywordtype">bool</span> value = <span class="keyword">false</span>;
<a name="l00361"></a>00361    <span class="keywordtype">int</span>  rport = atoi(port.c_str());
<a name="l00362"></a>00362    boost::system::error_code    ec; 
<a name="l00363"></a>00363    boost::asio::ip::udp::endpoint remote ( boost::asio::ip::address::from_string(host.c_str()), rport);
<a name="l00364"></a>00364 
<a name="l00365"></a>00365    stdDevIdx = (stdDevIdx == -1) ? <a class="code" href="classmdDGChannel.html#53722f0e0c46baae7dddc227af22ae68">mdStdDevIdx</a> : stdDevIdx;
<a name="l00366"></a>00366    map&lt;int,mdCB *&gt;::iterator iter = <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>.find(stdDevIdx);
<a name="l00367"></a>00367    <span class="keywordflow">if</span>( iter == <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>.end() ) <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[stdDevIdx] = <span class="keyword">new</span> <a class="code" href="mdcommon_8h.html#87657d3d6b1255a72ac635e7e04c5fcc">mdCB</a>();
<a name="l00368"></a>00368 
<a name="l00369"></a>00369    <span class="keywordflow">try</span> {
<a name="l00370"></a>00370      <span class="keywordflow">if</span> (!<a class="code" href="classmdDGChannel.html#adb8f139da49b3d4a5d020334539f295">r</a>) <a class="code" href="classmdDGChannel.html#adb8f139da49b3d4a5d020334539f295">r</a> = <span class="keyword">new</span> udp::resolver(<a class="code" href="classmdDGChannel.html#f214d4fd5b41dde7b05539b3adf250c7">io_service_</a>);
<a name="l00371"></a>00371      <span class="keywordflow">if</span> ( <a class="code" href="classmdDGChannel.html#37aeacb7e13840b3a03c141cacae1c12">q</a>)  <span class="keyword">delete</span> <a class="code" href="classmdDGChannel.html#37aeacb7e13840b3a03c141cacae1c12">q</a>;
<a name="l00372"></a>00372              <a class="code" href="classmdDGChannel.html#37aeacb7e13840b3a03c141cacae1c12">q</a> = <span class="keyword">new</span> udp::resolver::query(udp::v4(), host.c_str(), port.c_str());
<a name="l00373"></a>00373      <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[stdDevIdx]-&gt;it = <a class="code" href="classmdDGChannel.html#adb8f139da49b3d4a5d020334539f295">r</a>-&gt;resolve(*<a class="code" href="classmdDGChannel.html#37aeacb7e13840b3a03c141cacae1c12">q</a>);
<a name="l00374"></a>00374      <span class="keywordflow">if</span> (!<a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[<a class="code" href="classmdDGChannel.html#53722f0e0c46baae7dddc227af22ae68">mdStdDevIdx</a>]-&gt;udp)
<a name="l00375"></a>00375           <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[<a class="code" href="classmdDGChannel.html#53722f0e0c46baae7dddc227af22ae68">mdStdDevIdx</a>]-&gt;udp = <span class="keyword">new</span> <a class="code" href="lxi-control_8c.html#3666576f6b88007cc7b8f26c7da596c8">udp::socket</a>(<a class="code" href="classmdDGChannel.html#f214d4fd5b41dde7b05539b3adf250c7">io_service_</a>, udp::endpoint(udp::v4(), 0));
<a name="l00376"></a>00376      <a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a> = <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[<a class="code" href="classmdDGChannel.html#53722f0e0c46baae7dddc227af22ae68">mdStdDevIdx</a>]-&gt;udp;
<a name="l00377"></a>00377      <span class="keywordflow">if</span> (<a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>-&gt;is_open())
<a name="l00378"></a>00378          <a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>-&gt;connect(remote,ec);
<a name="l00379"></a>00379 
<a name="l00380"></a>00380      <span class="keywordflow">if</span> (!ec) value = <span class="keyword">true</span>;  
<a name="l00381"></a>00381 
<a name="l00382"></a>00382    } <span class="keywordflow">catch</span>(...) {}
<a name="l00383"></a>00383 
<a name="l00384"></a>00384    <span class="keywordflow">return</span> (<a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[stdDevIdx]-&gt;connection.open=value);
<a name="l00385"></a>00385 
<a name="l00386"></a>00386   }
<a name="l00387"></a>00387 
<a name="l00388"></a><a class="code" href="classmdDGChannel.html#85e0ff1db2561802a4408f0e31fd6e76">00388</a>   <span class="keywordtype">bool</span> <a class="code" href="classmdDGChannel.html#0ddcb3989f4b2035bb39f0e1d372945b">connect_to</a> (boost::asio::ip::udp::endpoint &amp;ep,boost::system::error_code &amp;ec,<span class="keywordtype">int</span> &amp;step,<span class="keywordtype">int</span> stdDevIdx=-1)
<a name="l00389"></a>00389   {
<a name="l00390"></a>00390    
<a name="l00391"></a>00391    <span class="keywordtype">bool</span>                   value = <span class="keyword">false</span>;
<a name="l00392"></a>00392 
<a name="l00393"></a>00393    stdDevIdx = stdDevIdx == -1 ? <a class="code" href="classmdDGChannel.html#53722f0e0c46baae7dddc227af22ae68">mdStdDevIdx</a> : stdDevIdx;
<a name="l00394"></a>00394    map&lt;int,mdCB *&gt;::iterator iter = <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>.find(stdDevIdx);
<a name="l00395"></a>00395     <span class="keywordflow">if</span>( iter == <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>.end() ) <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[stdDevIdx] = <span class="keyword">new</span> <a class="code" href="mdcommon_8h.html#87657d3d6b1255a72ac635e7e04c5fcc">mdCB</a>();
<a name="l00396"></a>00396 
<a name="l00397"></a>00397    <span class="keywordflow">try</span> { <span class="keywordflow">if</span> (<a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[stdDevIdx]-&gt;udp) {<span class="keywordflow">if</span> (<a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[stdDevIdx]-&gt;udp-&gt;is_open())
<a name="l00398"></a>00398                                       <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[stdDevIdx]-&gt;udp-&gt;close();
<a name="l00399"></a>00399                                   <span class="keyword">delete</span> <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[stdDevIdx]-&gt;udp;}
<a name="l00400"></a>00400 
<a name="l00401"></a>00401       <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[stdDevIdx]-&gt;ep  = ep;
<a name="l00402"></a>00402       <a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a> = <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[stdDevIdx]-&gt;udp = <span class="keyword">new</span> <a class="code" href="lxi-control_8c.html#3666576f6b88007cc7b8f26c7da596c8">boost::asio::ip::udp::socket</a>( <a class="code" href="classmdDGChannel.html#f214d4fd5b41dde7b05539b3adf250c7">io_service_</a> , udp::endpoint(udp::v4(), 0) );
<a name="l00403"></a>00403       ec.clear();
<a name="l00404"></a>00404       <a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>-&gt;connect( <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[stdDevIdx]-&gt;ep, ec );
<a name="l00405"></a>00405       <span class="keywordflow">if</span> (<a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>-&gt;is_open()) { value = <span class="keyword">true</span>; <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[stdDevIdx]-&gt;connection.open=1; }
<a name="l00406"></a>00406       <span class="keywordflow">else</span> {
<a name="l00407"></a>00407          step++;
<a name="l00408"></a>00408          <a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>-&gt;open( udp::v4(),  ec );
<a name="l00409"></a>00409          <span class="keywordflow">if</span> (<a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>-&gt;is_open()) {value = <span class="keyword">true</span>; <a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[stdDevIdx]-&gt;connection.open=1; }
<a name="l00410"></a>00410       }
<a name="l00411"></a>00411 
<a name="l00412"></a>00412    } 
<a name="l00413"></a>00413    <span class="keywordflow">catch</span>(boost::system::system_error &amp;be) {boost::system::system_error warning = be;} 
<a name="l00414"></a>00414    <span class="keywordflow">catch</span>(...) {}
<a name="l00415"></a>00415 
<a name="l00416"></a>00416    <span class="keywordflow">return</span> (value);
<a name="l00417"></a>00417 
<a name="l00418"></a>00418   }
<a name="l00419"></a>00419 
<a name="l00420"></a>00420   <span class="keywordtype">void</span> <a class="code" href="classmdDGChannel.html#061ed6e19546d4ea693e75862e00c57a">handle_receive_from</a>(<span class="keyword">const</span> boost::system::error_code&amp; error, <span class="keywordtype">size_t</span> bytes_recvd);
<a name="l00421"></a>00421 
<a name="l00422"></a><a class="code" href="classmdDGChannel.html#cecc96101c84895f91a24338b81e6618">00422</a>   <span class="keywordtype">void</span> <a class="code" href="classmdDGChannel.html#cecc96101c84895f91a24338b81e6618">handle_send_to</a>(<span class="keyword">const</span> boost::system::error_code&amp; asioEC,  <span class="keywordtype">size_t</span> sentByes)
<a name="l00423"></a>00423   {
<a name="l00424"></a>00424      <span class="keywordtype">size_t</span> dgSize = <a class="code" href="classmdDGChannel.html#c498de123b8f1135ed0a168c9456069a">inProcess</a>-&gt;<a class="code" href="structMD__DATAGRAM.html#291a1d2fb7d929c19670d021e6626401">hdr</a>.<a class="code" href="structMD__DG__HEADER.html#0018718733130a6c766e25e8e27e36bf">dgType</a>.<a class="code" href="structMD__DG__TYPE.html#65ae8fa3343299eb78fdf4940be4383b">requiresAck</a>
<a name="l00425"></a>00425                    ?  <span class="keyword">sizeof</span>(<a class="code" href="classmdReply.html">mdReply</a>) :  <span class="keyword">sizeof</span>(<a class="code" href="structMD__DATAGRAM.html">mdDatagram</a>);
<a name="l00426"></a>00426 
<a name="l00427"></a>00427       <span class="comment">//  std::string debugMsg = asioEC.message();</span>
<a name="l00428"></a>00428 
<a name="l00429"></a>00429       <span class="keywordflow">if</span> (<a class="code" href="classmdDGChannel.html#c498de123b8f1135ed0a168c9456069a">inProcess</a>-&gt;<a class="code" href="structMD__DATAGRAM.html#291a1d2fb7d929c19670d021e6626401">hdr</a>.<a class="code" href="structMD__DG__HEADER.html#0018718733130a6c766e25e8e27e36bf">dgType</a>.<a class="code" href="structMD__DG__TYPE.html#65ae8fa3343299eb78fdf4940be4383b">requiresAck</a>)
<a name="l00430"></a>00430         <a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>-&gt;async_receive_from(
<a name="l00431"></a>00431         boost::asio::buffer(<a class="code" href="classmdDGChannel.html#35a4d6bdea098e27c21fa91c02c2d20a">ack_</a>, dgSize), *<a class="code" href="classmdDGChannel.html#708f1a4af55f7094c364dd75a91acaf5">ep_</a>,
<a name="l00432"></a>00432         boost::bind(&amp;<a class="code" href="classmdDGChannel.html#061ed6e19546d4ea693e75862e00c57a">mdDGChannel::handle_receive_from</a>, <span class="keyword">this</span>,
<a name="l00433"></a>00433           boost::asio::placeholders::error,
<a name="l00434"></a>00434           boost::asio::placeholders::bytes_transferred));
<a name="l00435"></a>00435       <span class="keywordflow">else</span>
<a name="l00436"></a>00436         <a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>-&gt;async_receive_from(
<a name="l00437"></a>00437         boost::asio::buffer(<a class="code" href="classmdDGChannel.html#fed9a3cbfbf85f8bf1b74bbbc25678c8">data_</a>, dgSize), *<a class="code" href="classmdDGChannel.html#708f1a4af55f7094c364dd75a91acaf5">ep_</a>,
<a name="l00438"></a>00438         boost::bind(&amp;<a class="code" href="classmdDGChannel.html#061ed6e19546d4ea693e75862e00c57a">mdDGChannel::handle_receive_from</a>, <span class="keyword">this</span>,
<a name="l00439"></a>00439           boost::asio::placeholders::error,
<a name="l00440"></a>00440           boost::asio::placeholders::bytes_transferred));
<a name="l00441"></a>00441   }
<a name="l00442"></a>00442 
<a name="l00443"></a><a class="code" href="classmdDGChannel.html#d206452bcec575ebc5e86aa476290b1a">00443</a>   <span class="keywordtype">bool</span> <a class="code" href="classmdDGChannel.html#d206452bcec575ebc5e86aa476290b1a">send</a>(<a class="code" href="structMD__DATAGRAM.html">mdDatagram</a> &amp;dg) {
<a name="l00444"></a>00444 
<a name="l00445"></a>00445       <span class="keywordtype">size_t</span> dgSize = <span class="keyword">sizeof</span>(<a class="code" href="structMD__DG__HEADER.html">mdDGHeader</a>) + dg.<a class="code" href="structMD__DATAGRAM.html#291a1d2fb7d929c19670d021e6626401">hdr</a>.<a class="code" href="structMD__DG__HEADER.html#6947aef60794553c98b4fe7e7e5a68f2">payloadSize</a>;
<a name="l00446"></a>00446 
<a name="l00447"></a>00447       return (dgSize == 
<a name="l00448"></a>00448       <a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>-&gt;send(boost::asio::buffer((<span class="keywordtype">void</span> *)&amp;dg, dgSize)));
<a name="l00449"></a>00449 
<a name="l00450"></a>00450   }
<a name="l00451"></a>00451 
<a name="l00452"></a><a class="code" href="classmdDGChannel.html#ec967a8951f418640418c3ebacf8c0f4">00452</a>   <span class="keywordtype">bool</span> <a class="code" href="classmdDGChannel.html#ec967a8951f418640418c3ebacf8c0f4">send_to</a>(<a class="code" href="structMD__DATAGRAM.html">mdDatagram</a> &amp;dg, <span class="keywordtype">int</span> <a class="code" href="classmdDGChannel.html#53722f0e0c46baae7dddc227af22ae68">mdStdDevIdx</a>) {
<a name="l00453"></a>00453 
<a name="l00454"></a>00454       <span class="keywordtype">size_t</span> dgSize = <span class="keyword">sizeof</span>(<a class="code" href="structMD__DG__HEADER.html">mdDGHeader</a>) + dg.<a class="code" href="structMD__DATAGRAM.html#291a1d2fb7d929c19670d021e6626401">hdr</a>.<a class="code" href="structMD__DG__HEADER.html#6947aef60794553c98b4fe7e7e5a68f2">payloadSize</a>;
<a name="l00455"></a>00455 
<a name="l00456"></a>00456       return (dgSize == 
<a name="l00457"></a>00457       <a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>-&gt;send_to(boost::asio::buffer((<span class="keywordtype">void</span> *)&amp;dg, dgSize), *<a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[mdStdDevIdx]-&gt;it));
<a name="l00458"></a>00458 
<a name="l00459"></a>00459   }
<a name="l00460"></a>00460 
<a name="l00461"></a><a class="code" href="classmdDGChannel.html#19be2c4adbdef10e23620801f7bb00ba">00461</a>   <span class="keywordtype">size_t</span> <a class="code" href="classmdDGChannel.html#d206452bcec575ebc5e86aa476290b1a">send</a>(<a class="code" href="classmdReply.html">mdReply</a> &amp;dg, boost::system::error_code &amp;ec) {
<a name="l00462"></a>00462 
<a name="l00463"></a>00463       <span class="keywordtype">size_t</span> dgSize = <span class="keyword">sizeof</span>(<a class="code" href="structMD__REPLY.html">mdDGReply</a>);
<a name="l00464"></a>00464       boost::asio::socket_base::message_flags  flags=0;
<a name="l00465"></a>00465 
<a name="l00466"></a>00466       <span class="keywordflow">return</span> (<a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>-&gt;send(boost::asio::buffer((<span class="keywordtype">void</span> *)&amp;dg, dgSize), flags, ec));
<a name="l00467"></a>00467 
<a name="l00468"></a>00468   }
<a name="l00469"></a>00469  
<a name="l00470"></a><a class="code" href="classmdDGChannel.html#09be155196e5a3cdbfa99d8a4550772b">00470</a>   <span class="keywordtype">size_t</span> <a class="code" href="classmdDGChannel.html#09be155196e5a3cdbfa99d8a4550772b">send_back</a>(<a class="code" href="classmdReply.html">mdReply</a> &amp;dg, boost::system::error_code &amp;ec, <span class="keywordtype">int</span> &amp;step) {
<a name="l00471"></a>00471 
<a name="l00472"></a>00472       <span class="keywordtype">size_t</span> dgSize = <span class="keyword">sizeof</span>(<a class="code" href="structMD__REPLY.html">mdDGReply</a>);
<a name="l00473"></a>00473       boost::asio::socket_base::message_flags  flags=0;
<a name="l00474"></a>00474       step = 1;
<a name="l00475"></a>00475 
<a name="l00476"></a>00476       <a class="code" href="classmdDGChannel.html#4bef79f3fe5f96f3c0c545736bff9f74">a_endpoint_</a> = <a class="code" href="classmdDGChannel.html#742843f16459d561ea5527be8a0d44f3">passive_</a>.remote_endpoint(ec);
<a name="l00477"></a>00477 
<a name="l00478"></a>00478       <span class="keywordflow">if</span> (ec) <span class="keywordflow">return</span> 0;
<a name="l00479"></a>00479     
<a name="l00480"></a>00480       <span class="keywordflow">return</span> (<a class="code" href="classmdDGChannel.html#742843f16459d561ea5527be8a0d44f3">passive_</a>.send_to(boost::asio::buffer((<span class="keywordtype">void</span> *)&amp;dg, dgSize), <a class="code" href="classmdDGChannel.html#4bef79f3fe5f96f3c0c545736bff9f74">a_endpoint_</a>, flags, ec));
<a name="l00481"></a>00481 
<a name="l00482"></a>00482   }
<a name="l00483"></a>00483 
<a name="l00484"></a><a class="code" href="classmdDGChannel.html#0a17fe2da9899ca9cca8a16ce02158f0">00484</a>   <span class="keywordtype">bool</span> <a class="code" href="classmdDGChannel.html#ec967a8951f418640418c3ebacf8c0f4">send_to</a>(<a class="code" href="classmdReply.html">mdReply</a> &amp;dg,<span class="keywordtype">int</span> <a class="code" href="classmdDGChannel.html#53722f0e0c46baae7dddc227af22ae68">mdStdDevIdx</a>) {
<a name="l00485"></a>00485 
<a name="l00486"></a>00486       <span class="keywordtype">size_t</span> dgSize = <span class="keyword">sizeof</span>(<a class="code" href="structMD__REPLY.html">mdDGReply</a>);
<a name="l00487"></a>00487 
<a name="l00488"></a>00488       <span class="keywordflow">return</span> (dgSize == 
<a name="l00489"></a>00489       <a class="code" href="classmdDGChannel.html#b335710656d1b88052f4cb1528053c38">active_</a>-&gt;send_to(boost::asio::buffer((<span class="keywordtype">void</span> *)&amp;dg, dgSize), *<a class="code" href="mdcommon_8h.html#cfe8bc8eb94478cd33a991905fef470f">cb</a>[mdStdDevIdx]-&gt;it));
<a name="l00490"></a>00490 
<a name="l00491"></a>00491   }
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 };
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 
<a name="l00496"></a>00496 <span class="preprocessor">#if defined(_WIN32_WINNT) &amp;&amp; !defined(DllExport) &amp;&amp; defined(DV_DLL)</span>
<a name="l00497"></a>00497 <span class="preprocessor"></span><span class="preprocessor">#pragma warning( disable: 4251 )</span>
<a name="l00498"></a>00498 <span class="preprocessor"></span><span class="preprocessor">#define DllExport __declspec(dllexport)</span>
<a name="l00499"></a>00499 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00500"></a>00500 <span class="preprocessor"></span><span class="preprocessor">#define DllExport</span>
<a name="l00501"></a>00501 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00502"></a>00502 <span class="preprocessor"></span>        
<a name="l00503"></a><a class="code" href="mdcommon_8h.html#af3d4401f5ed2f1310a0aeb2be52a388">00503</a> <span class="keyword">typedef</span> std::map&lt;int,std::string&gt; <a class="code" href="mdcommon_8h.html#af3d4401f5ed2f1310a0aeb2be52a388">mdErrMsgMap</a>;
<a name="l00504"></a>00504 
<a name="l00505"></a><a class="code" href="classmdError.html">00505</a> <span class="keyword">class </span>DllExport <a class="code" href="classmdError.html">mdError</a> {
<a name="l00506"></a>00506  
<a name="l00507"></a>00507   <span class="keywordtype">int</span>         <a class="code" href="structinstance.html">instance</a>; 
<a name="l00508"></a>00508   <a class="code" href="mdcommon_8h.html#af3d4401f5ed2f1310a0aeb2be52a388">mdErrMsgMap</a>     text;
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 <span class="keyword">public</span>: 
<a name="l00511"></a><a class="code" href="classmdError.html#8e0c4ea7a7bc07992487abe80fe22e64">00511</a>    <a class="code" href="classmdError.html">mdError</a>() { text[0]  = std::string(<span class="stringliteral">"OK"</span>);
<a name="l00512"></a>00512                <a class="code" href="structinstance.html">instance</a> = 0;
<a name="l00513"></a>00513              }
<a name="l00514"></a>00514 
<a name="l00515"></a><a class="code" href="classmdError.html#fb6944ddddc6970cdf34bcf8bad8a6f5">00515</a>   ~<a class="code" href="classmdError.html">mdError</a>() {}
<a name="l00516"></a>00516  
<a name="l00517"></a>00517    <span class="comment">// The below populate the additional messages;</span>
<a name="l00518"></a>00518    <span class="comment">// Instances below 1000 are reserved for system errors, negative</span>
<a name="l00519"></a>00519    <span class="comment">// integers not used.</span>
<a name="l00520"></a>00520    <span class="comment">// Users derive from this class and implement additionalUsrMsgs.</span>
<a name="l00521"></a>00521 
<a name="l00522"></a><a class="code" href="classmdError.html#489e5fdafa462f8f51892e826d0a219c">00522</a>    <span class="keywordtype">void</span>     additionalUserMsg(<span class="keywordtype">int</span> instCode,<span class="keyword">const</span> <span class="keywordtype">char</span> *msgText)
<a name="l00523"></a>00523    {<span class="keywordflow">if</span> (instCode &gt;= 1000) text[instCode] = std::string(msgText);}
<a name="l00524"></a><a class="code" href="classmdError.html#8b120f0175f936fe8e218edb32a3ad8c">00524</a>    <span class="keywordtype">void</span> additionalSystemMsg(<span class="keywordtype">int</span> instCode,<span class="keyword">const</span> <span class="keywordtype">char</span> *msgText)
<a name="l00525"></a>00525    {<span class="keywordflow">if</span> (instCode &lt; 1000 &amp;&amp; instCode &gt;0) text[instCode] = std::string(msgText);}
<a name="l00526"></a>00526 
<a name="l00527"></a><a class="code" href="classmdError.html#58bfd8b0c206c0573e5586ad71eec853">00527</a>    <span class="keywordtype">int</span>      <span class="keyword">get</span>()        {<span class="keywordflow">return</span> <a class="code" href="structinstance.html">instance</a>;}
<a name="l00528"></a><a class="code" href="classmdError.html#844a0d91d0872db3b88e3b46f3c1cd2f">00528</a>    <span class="keywordtype">void</span>     <span class="keyword">get</span>(<a class="code" href="classmdError.html">mdError</a> **parentPtr)
<a name="l00529"></a>00529                          {*parentPtr = <span class="keyword">this</span>;}
<a name="l00530"></a><a class="code" href="classmdError.html#bc44bee63f263a3ba7d16579a346ac2c">00530</a>    <span class="keywordtype">void</span>     <span class="keyword">set</span>(<span class="keywordtype">int</span> i)   {<a class="code" href="structinstance.html">instance</a> = i;}
<a name="l00531"></a>00531 
<a name="l00532"></a><a class="code" href="classmdError.html#533200a14555cb7bf496830855b0e243">00532</a>    <span class="keyword">const</span> <span class="keywordtype">char</span> *what(<span class="keywordtype">char</span> *buffer=NULL) {
<a name="l00533"></a>00533      <span class="keywordflow">if</span> (text.find(<span class="keyword">get</span>()) == text.end()) {
<a name="l00534"></a>00534       {<span class="keywordflow">if</span> (!buffer) <span class="keywordflow">return</span> NULL;
<a name="l00535"></a>00535        sprintf(buffer,<span class="stringliteral">"Unknown error code: %d"</span>,<span class="keyword">get</span>());
<a name="l00536"></a>00536        <span class="keywordflow">return</span> buffer;
<a name="l00537"></a>00537       } 
<a name="l00538"></a>00538       <span class="keywordflow">return</span> text[<span class="keyword">get</span>()].c_str();
<a name="l00539"></a>00539      }
<a name="l00540"></a>00540      <span class="keywordflow">return</span> <span class="stringliteral">"unknown"</span>;
<a name="l00541"></a>00541    }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 };
<a name="l00544"></a>00544 
<a name="l00545"></a><a class="code" href="classmdDG.html">00545</a> <span class="keyword">class </span><a class="code" href="classmdDG.html">mdDG</a> {
<a name="l00546"></a>00546 <span class="keyword">public</span>:
<a name="l00547"></a><a class="code" href="classmdDG.html#bc12b81f2722486b819e86c3f4fc93a1">00547</a>   <a class="code" href="structMD__DATAGRAM.html">mdDatagram</a> <a class="code" href="classmdDG.html#bc12b81f2722486b819e86c3f4fc93a1">dg</a>;
<a name="l00548"></a>00548 
<a name="l00549"></a><a class="code" href="classmdDG.html#505bc80bfe26fa3453587abdaa2784ec">00549</a>   <a class="code" href="classmdDG.html#505bc80bfe26fa3453587abdaa2784ec">mdDG</a>() {memset(&amp;<a class="code" href="classmdDG.html#bc12b81f2722486b819e86c3f4fc93a1">dg</a>,0,<span class="keyword">sizeof</span>(<a class="code" href="structMD__DATAGRAM.html">mdDatagram</a>));}
<a name="l00550"></a>00550 
<a name="l00551"></a>00551 };
<a name="l00552"></a>00552 
<a name="l00553"></a>00553 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jan 10 23:49:16 2011 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
