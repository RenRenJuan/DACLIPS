<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>src/clipsrules/core/rulelhs.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>src/clipsrules/core/rulelhs.c</h1><a href="rulelhs_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001    <span class="comment">/*******************************************************/</span>
<a name="l00002"></a>00002    <span class="comment">/*      "C" Language Integrated Production System      */</span>
<a name="l00003"></a>00003    <span class="comment">/*                                                     */</span>
<a name="l00004"></a>00004    <span class="comment">/*             CLIPS Version 6.22  06/15/04            */</span>
<a name="l00005"></a>00005    <span class="comment">/*                                                     */</span>
<a name="l00006"></a>00006    <span class="comment">/*             DEFRULE LHS PARSING MODULE              */</span>
<a name="l00007"></a>00007    <span class="comment">/*******************************************************/</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="comment">/*************************************************************/</span>
<a name="l00010"></a>00010 <span class="comment">/* Purpose: Coordinates parsing of the LHS conditional       */</span>
<a name="l00011"></a>00011 <span class="comment">/*   elements of a rule.                                     */</span>
<a name="l00012"></a>00012 <span class="comment">/*                                                           */</span>
<a name="l00013"></a>00013 <span class="comment">/* Principal Programmer(s):                                  */</span>
<a name="l00014"></a>00014 <span class="comment">/*      Gary D. Riley                                        */</span>
<a name="l00015"></a>00015 <span class="comment">/*                                                           */</span>
<a name="l00016"></a>00016 <span class="comment">/* Contributing Programmer(s):                               */</span>
<a name="l00017"></a>00017 <span class="comment">/*                                                           */</span>
<a name="l00018"></a>00018 <span class="comment">/* Revision History:                                         */</span>
<a name="l00019"></a>00019 <span class="comment">/*                                                           */</span>
<a name="l00020"></a>00020 <span class="comment">/*************************************************************/</span>
<a name="l00021"></a>00021 
<a name="l00022"></a><a class="code" href="rulelhs_8c.html#14cfed0b77613a623b1a3cc864f60b83">00022</a> <span class="preprocessor">#define _RULELHS_SOURCE_</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span>
<a name="l00024"></a>00024 <span class="preprocessor">#include "<a class="code" href="setup_8h.html">setup.h</a>"</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="preprocessor">#if (! RUN_TIME) &amp;&amp; (! BLOAD_ONLY) &amp;&amp;  DEFRULE_CONSTRUCT</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00029"></a><a class="code" href="rulelhs_8c.html#6e4807994d76152e81b38b27baabf806">00029</a> <span class="preprocessor">#define _STDIO_INCLUDED_</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="preprocessor">#include "<a class="code" href="agenda_8h.html">agenda.h</a>"</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include "<a class="code" href="argacces_8h.html">argacces.h</a>"</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include "<a class="code" href="constant_8h.html">constant.h</a>"</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include "<a class="code" href="constrct_8h.html">constrct.h</a>"</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include "<a class="code" href="constrnt_8h.html">constrnt.h</a>"</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include "<a class="code" href="cstrnchk_8h.html">cstrnchk.h</a>"</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include "<a class="code" href="envrnmnt_8h.html">envrnmnt.h</a>"</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include "<a class="code" href="exprnpsr_8h.html">exprnpsr.h</a>"</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include "<a class="code" href="memalloc_8h.html">memalloc.h</a>"</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include "<a class="code" href="pattern_8h.html">pattern.h</a>"</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include "<a class="code" href="reorder_8h.html">reorder.h</a>"</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include "<a class="code" href="router_8h.html">router.h</a>"</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include "<a class="code" href="ruledef_8h.html">ruledef.h</a>"</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include "<a class="code" href="scanner_8h.html">scanner.h</a>"</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include "<a class="code" href="symbol_8h.html">symbol.h</a>"</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="preprocessor">#include "<a class="code" href="rulelhs_8h.html">rulelhs.h</a>"</span>
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="comment">/***************************************/</span>
<a name="l00051"></a>00051 <span class="comment">/* LOCAL INTERNAL FUNCTION DEFINITIONS */</span>
<a name="l00052"></a>00052 <span class="comment">/***************************************/</span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054    <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a>    *RuleBodyParse(<span class="keywordtype">void</span> *,<span class="keywordtype">char</span> *,<span class="keyword">struct</span> <a class="code" href="structtoken.html">token</a> *,<span class="keywordtype">char</span> *,<span class="keywordtype">int</span> *);
<a name="l00055"></a>00055    <span class="keyword">static</span> <span class="keywordtype">void</span>                    DeclarationParse(<span class="keywordtype">void</span> *,<span class="keywordtype">char</span> *,<span class="keywordtype">char</span> *,<span class="keywordtype">int</span> *);
<a name="l00056"></a>00056    <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a>    *LHSPattern(<span class="keywordtype">void</span> *,<span class="keywordtype">char</span> *,<span class="keywordtype">int</span>,<span class="keywordtype">char</span> *,<span class="keywordtype">int</span> *,<span class="keywordtype">int</span>,
<a name="l00057"></a>00057                                              <span class="keyword">struct</span> <a class="code" href="structtoken.html">token</a> *,<span class="keywordtype">char</span> *);
<a name="l00058"></a>00058    <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a>    *ConnectedPatternParse(<span class="keywordtype">void</span> *,<span class="keywordtype">char</span> *,<span class="keyword">struct</span> <a class="code" href="structtoken.html">token</a> *,<span class="keywordtype">int</span> *);
<a name="l00059"></a>00059    <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a>    *GroupPatterns(<span class="keywordtype">void</span> *,<span class="keywordtype">char</span> *,<span class="keywordtype">int</span>,<span class="keywordtype">char</span> *,<span class="keywordtype">int</span> *);
<a name="l00060"></a>00060    <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a>    *TestPattern(<span class="keywordtype">void</span> *,<span class="keywordtype">char</span> *,<span class="keywordtype">int</span> *);
<a name="l00061"></a>00061    <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a>    *AssignmentParse(<span class="keywordtype">void</span> *,<span class="keywordtype">char</span> *,<a class="code" href="structsymbolHashNode.html">SYMBOL_HN</a> *,<span class="keywordtype">int</span> *);
<a name="l00062"></a>00062    <span class="keyword">static</span> <span class="keywordtype">void</span>                    TagLHSLogicalNodes(<span class="keyword">struct</span> <a class="code" href="structlhsParseNode.html">lhsParseNode</a> *);
<a name="l00063"></a>00063    <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a>    *SimplePatternParse(<span class="keywordtype">void</span> *,<span class="keywordtype">char</span> *,<span class="keyword">struct</span> <a class="code" href="structtoken.html">token</a> *,<span class="keywordtype">int</span> *);
<a name="l00064"></a>00064    <span class="keyword">static</span> <span class="keywordtype">void</span>                    ParseSalience(<span class="keywordtype">void</span> *,<span class="keywordtype">char</span> *,<span class="keywordtype">char</span> *,<span class="keywordtype">int</span> *);
<a name="l00065"></a>00065    <span class="keyword">static</span> <span class="keywordtype">void</span>                    ParseAutoFocus(<span class="keywordtype">void</span> *,<span class="keywordtype">char</span> *,<span class="keywordtype">int</span> *);
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="comment">/*******************************************************************/</span>
<a name="l00068"></a>00068 <span class="comment">/* ParseRuleLHS: Coordinates all the actions necessary for parsing */</span>
<a name="l00069"></a>00069 <span class="comment">/*   the LHS of a rule including the reordering of pattern         */</span>
<a name="l00070"></a>00070 <span class="comment">/*   conditional elements to conform with the KB Rete topology.    */</span>
<a name="l00071"></a>00071 <span class="comment">/*******************************************************************/</span>
<a name="l00072"></a><a class="code" href="rulelhs_8h.html#05fe8e0b8e0a511cc5074866131aec5d">00072</a> <a class="code" href="setup_8h.html#62417931fe8ecc3bd4d0051db7687573">globle</a> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *<a class="code" href="rulelhs_8c.html#d9c4edd4eb61ade98a830d15778d322d">ParseRuleLHS</a>(
<a name="l00073"></a>00073   <span class="keywordtype">void</span> *theEnv,
<a name="l00074"></a>00074   <span class="keywordtype">char</span> *readSource,
<a name="l00075"></a>00075   <span class="keyword">struct</span> <a class="code" href="structtoken.html">token</a> *theToken,
<a name="l00076"></a>00076   <span class="keywordtype">char</span> *ruleName,
<a name="l00077"></a>00077   <span class="keywordtype">int</span> *error)
<a name="l00078"></a>00078   {
<a name="l00079"></a>00079    <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *theLHS;
<a name="l00080"></a>00080    <span class="keywordtype">int</span> result;
<a name="l00081"></a>00081    
<a name="l00082"></a>00082    *error = <a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00083"></a>00083 
<a name="l00084"></a>00084    <span class="comment">/*========================================*/</span>
<a name="l00085"></a>00085    <span class="comment">/* Initialize salience parsing variables. */</span>
<a name="l00086"></a>00086    <span class="comment">/*========================================*/</span>
<a name="l00087"></a>00087 
<a name="l00088"></a>00088    <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;GlobalSalience = 0;
<a name="l00089"></a>00089    <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;GlobalAutoFocus = <a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00090"></a>00090    <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression = NULL;
<a name="l00091"></a>00091 
<a name="l00092"></a>00092    <span class="comment">/*============================*/</span>
<a name="l00093"></a>00093    <span class="comment">/* Set the indentation depth. */</span>
<a name="l00094"></a>00094    <span class="comment">/*============================*/</span>
<a name="l00095"></a>00095 
<a name="l00096"></a>00096    <a class="code" href="pprint_8c.html#7befe3c9e21ba5c78f6d9d7ab533d3f3">SetIndentDepth</a>(theEnv,3);
<a name="l00097"></a>00097 
<a name="l00098"></a>00098    <span class="comment">/*=====================================================*/</span>
<a name="l00099"></a>00099    <span class="comment">/* Get the raw representation for the LHS of the rule. */</span>
<a name="l00100"></a>00100    <span class="comment">/*=====================================================*/</span>
<a name="l00101"></a>00101 
<a name="l00102"></a>00102    theLHS = RuleBodyParse(theEnv,readSource,theToken,ruleName,error);
<a name="l00103"></a>00103 
<a name="l00104"></a>00104    <span class="keywordflow">if</span> (*error) <span class="keywordflow">return</span>(NULL);
<a name="l00105"></a>00105 
<a name="l00106"></a>00106    <span class="comment">/*====================================================*/</span>
<a name="l00107"></a>00107    <span class="comment">/* Reorder the raw representation so that it consists */</span>
<a name="l00108"></a>00108    <span class="comment">/* of at most a single top level OR CE containing one */</span>
<a name="l00109"></a>00109    <span class="comment">/* or more AND CEs.                                   */</span>
<a name="l00110"></a>00110    <span class="comment">/*====================================================*/</span>
<a name="l00111"></a>00111 
<a name="l00112"></a>00112    theLHS = <a class="code" href="reorder_8c.html#f3f0a6ae935050606476305a8af5f0fd">ReorderPatterns</a>(theEnv,theLHS,&amp;result);
<a name="l00113"></a>00113 
<a name="l00114"></a>00114    <span class="comment">/*================================*/</span>
<a name="l00115"></a>00115    <span class="comment">/* Return the LHS representation. */</span>
<a name="l00116"></a>00116    <span class="comment">/*================================*/</span>
<a name="l00117"></a>00117 
<a name="l00118"></a>00118    <span class="keywordflow">return</span>(theLHS);
<a name="l00119"></a>00119   }
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 <span class="comment">/*********************************************************/</span>
<a name="l00122"></a>00122 <span class="comment">/* RuleBodyParse: Parses the LHS of a rule, but does not */</span>
<a name="l00123"></a>00123 <span class="comment">/*   reorder any of the LHS patterns to conform with the */</span>
<a name="l00124"></a>00124 <span class="comment">/*   KB Rete Topology.                                   */</span>
<a name="l00125"></a>00125 <span class="comment">/*                                                       */</span>
<a name="l00126"></a>00126 <span class="comment">/* &lt;rule-body&gt; ::= [&lt;declaration&gt;]                       */</span>
<a name="l00127"></a>00127 <span class="comment">/*                 &lt;conditional-element&gt;*                */</span>
<a name="l00128"></a>00128 <span class="comment">/*                 =&gt;                                    */</span>
<a name="l00129"></a>00129 <span class="comment">/*********************************************************/</span>
<a name="l00130"></a>00130 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *RuleBodyParse(
<a name="l00131"></a>00131   <span class="keywordtype">void</span> *theEnv,
<a name="l00132"></a>00132   <span class="keywordtype">char</span> *readSource,
<a name="l00133"></a>00133   <span class="keyword">struct</span> <a class="code" href="structtoken.html">token</a> *theToken,
<a name="l00134"></a>00134   <span class="keywordtype">char</span> *ruleName,
<a name="l00135"></a>00135   <span class="keywordtype">int</span> *error)
<a name="l00136"></a>00136   {
<a name="l00137"></a>00137    <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *theNode, *otherNodes;
<a name="l00138"></a>00138 
<a name="l00139"></a>00139    <span class="comment">/*=============================*/</span>
<a name="l00140"></a>00140    <span class="comment">/* Set the error return value. */</span>
<a name="l00141"></a>00141    <span class="comment">/*=============================*/</span>
<a name="l00142"></a>00142 
<a name="l00143"></a>00143    *error = <a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00144"></a>00144 
<a name="l00145"></a>00145    <span class="comment">/*==================================================*/</span>
<a name="l00146"></a>00146    <span class="comment">/* If we're already at the separator, "=&gt;", between */</span>
<a name="l00147"></a>00147    <span class="comment">/* the LHS and RHS, then the LHS is empty.          */</span>
<a name="l00148"></a>00148    <span class="comment">/*==================================================*/</span>
<a name="l00149"></a>00149 
<a name="l00150"></a>00150    <span class="keywordflow">if</span> ((theToken-&gt;<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> == <a class="code" href="constant_8h.html#5f9ae9ce6aa6f82108b260135b2e63a0">SYMBOL</a>) ?
<a name="l00151"></a>00151        (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken-&gt;<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"=&gt;"</span>) == 0) : <a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l00152"></a>00152      { <span class="keywordflow">return</span>(NULL); }
<a name="l00153"></a>00153 
<a name="l00154"></a>00154    <span class="comment">/*===========================================*/</span>
<a name="l00155"></a>00155    <span class="comment">/* Parse the first pattern as a special case */</span>
<a name="l00156"></a>00156    <span class="comment">/* (the declare statement is allowed).       */</span>
<a name="l00157"></a>00157    <span class="comment">/*===========================================*/</span>
<a name="l00158"></a>00158 
<a name="l00159"></a>00159    theNode = LHSPattern(theEnv,readSource,<a class="code" href="constant_8h.html#5f9ae9ce6aa6f82108b260135b2e63a0">SYMBOL</a>,<span class="stringliteral">"=&gt;"</span>,error,<a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,theToken,ruleName);
<a name="l00160"></a>00160 
<a name="l00161"></a>00161    <span class="keywordflow">if</span> (*error == <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l00162"></a>00162      {
<a name="l00163"></a>00163       <a class="code" href="reorder_8c.html#36adfa94188ac9a3092e8a19d19312c9">ReturnLHSParseNodes</a>(theEnv,theNode);
<a name="l00164"></a>00164       <span class="keywordflow">return</span>(NULL);
<a name="l00165"></a>00165      }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167    <a class="code" href="pprint_8c.html#5e134cd66ac894adf35c7e385aec86ea">PPCRAndIndent</a>(theEnv);
<a name="l00168"></a>00168 
<a name="l00169"></a>00169    <span class="comment">/*======================================*/</span>
<a name="l00170"></a>00170    <span class="comment">/* Parse the other patterns in the LHS. */</span>
<a name="l00171"></a>00171    <span class="comment">/*======================================*/</span>
<a name="l00172"></a>00172 
<a name="l00173"></a>00173    otherNodes = GroupPatterns(theEnv,readSource,<a class="code" href="constant_8h.html#5f9ae9ce6aa6f82108b260135b2e63a0">SYMBOL</a>,<span class="stringliteral">"=&gt;"</span>,error);
<a name="l00174"></a>00174 
<a name="l00175"></a>00175    <span class="keywordflow">if</span> (*error == <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l00176"></a>00176      {
<a name="l00177"></a>00177       <a class="code" href="reorder_8c.html#36adfa94188ac9a3092e8a19d19312c9">ReturnLHSParseNodes</a>(theEnv,theNode);
<a name="l00178"></a>00178       <span class="keywordflow">return</span>(NULL);
<a name="l00179"></a>00179      }
<a name="l00180"></a>00180 
<a name="l00181"></a>00181    <span class="comment">/*================================================*/</span>
<a name="l00182"></a>00182    <span class="comment">/* Construct the final LHS by combining the first */</span>
<a name="l00183"></a>00183    <span class="comment">/* pattern with the remaining patterns.           */</span>
<a name="l00184"></a>00184    <span class="comment">/*================================================*/</span>
<a name="l00185"></a>00185 
<a name="l00186"></a>00186    <span class="keywordflow">if</span> (theNode == NULL)
<a name="l00187"></a>00187      { theNode = otherNodes; }
<a name="l00188"></a>00188    <span class="keywordflow">else</span>
<a name="l00189"></a>00189      { theNode-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a> = otherNodes; }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191    <span class="comment">/*=======================*/</span>
<a name="l00192"></a>00192    <span class="comment">/* Return the final LHS. */</span>
<a name="l00193"></a>00193    <span class="comment">/*=======================*/</span>
<a name="l00194"></a>00194 
<a name="l00195"></a>00195    <span class="keywordflow">return</span>(theNode);
<a name="l00196"></a>00196   }
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 <span class="comment">/********************************************************/</span>
<a name="l00199"></a>00199 <span class="comment">/* DeclarationParse: Parses a defrule declaration.      */</span>
<a name="l00200"></a>00200 <span class="comment">/*                                                      */</span>
<a name="l00201"></a>00201 <span class="comment">/* &lt;declaration&gt; ::= (declare &lt;rule-property&gt;+)         */</span>
<a name="l00202"></a>00202 <span class="comment">/*                                                      */</span>
<a name="l00203"></a>00203 <span class="comment">/* &lt;rule-property&gt; ::= (salience &lt;integer-expression&gt;)  */</span>
<a name="l00204"></a>00204 <span class="comment">/* &lt;rule-property&gt; ::= (auto-focus TRUE | FALSE)        */</span>
<a name="l00205"></a>00205 <span class="comment">/********************************************************/</span>
<a name="l00206"></a>00206 <span class="keyword">static</span> <span class="keywordtype">void</span> DeclarationParse(
<a name="l00207"></a>00207   <span class="keywordtype">void</span> *theEnv,
<a name="l00208"></a>00208   <span class="keywordtype">char</span> *readSource,
<a name="l00209"></a>00209   <span class="keywordtype">char</span> *ruleName,
<a name="l00210"></a>00210   <span class="keywordtype">int</span> *error)
<a name="l00211"></a>00211   {
<a name="l00212"></a>00212    <span class="keyword">struct </span><a class="code" href="structtoken.html">token</a> theToken;
<a name="l00213"></a>00213    <span class="keyword">struct </span><a class="code" href="structexpr.html">expr</a> *packPtr;
<a name="l00214"></a>00214    <span class="keywordtype">int</span> notDone = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00215"></a>00215    <span class="keywordtype">int</span> salienceParsed = <a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>, autoFocusParsed = <a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00216"></a>00216 
<a name="l00217"></a>00217    <span class="comment">/*===========================*/</span>
<a name="l00218"></a>00218    <span class="comment">/* Next token must be a '('. */</span>
<a name="l00219"></a>00219    <span class="comment">/*===========================*/</span>
<a name="l00220"></a>00220 
<a name="l00221"></a>00221    <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,<span class="stringliteral">" "</span>);
<a name="l00222"></a>00222 
<a name="l00223"></a>00223    <a class="code" href="scanner_8c.html#e909573743f1f7fd3b00d28c96f6a7d3">GetToken</a>(theEnv,readSource,&amp;theToken);
<a name="l00224"></a>00224    <span class="keywordflow">if</span> (theToken.<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> != <a class="code" href="constant_8h.html#be30756b10aa77b095a8737a0d0b63ef">LPAREN</a>)
<a name="l00225"></a>00225      {
<a name="l00226"></a>00226       <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"declare statement"</span>);
<a name="l00227"></a>00227       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00228"></a>00228       <span class="keywordflow">return</span>;
<a name="l00229"></a>00229      }
<a name="l00230"></a>00230 
<a name="l00231"></a>00231    <span class="comment">/*==========================================*/</span>
<a name="l00232"></a>00232    <span class="comment">/* Continue parsing until there are no more */</span>
<a name="l00233"></a>00233    <span class="comment">/* valid rule property declarations.        */</span>
<a name="l00234"></a>00234    <span class="comment">/*==========================================*/</span>
<a name="l00235"></a>00235 
<a name="l00236"></a>00236    <span class="keywordflow">while</span> (notDone)
<a name="l00237"></a>00237      {
<a name="l00238"></a>00238       <span class="comment">/*=============================================*/</span>
<a name="l00239"></a>00239       <span class="comment">/* The name of a rule property must be symbol. */</span>
<a name="l00240"></a>00240       <span class="comment">/*=============================================*/</span>
<a name="l00241"></a>00241 
<a name="l00242"></a>00242       <a class="code" href="scanner_8c.html#e909573743f1f7fd3b00d28c96f6a7d3">GetToken</a>(theEnv,readSource,&amp;theToken);
<a name="l00243"></a>00243       <span class="keywordflow">if</span> (theToken.<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> != <a class="code" href="constant_8h.html#5f9ae9ce6aa6f82108b260135b2e63a0">SYMBOL</a>)
<a name="l00244"></a>00244         {
<a name="l00245"></a>00245          <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"declare statement"</span>);
<a name="l00246"></a>00246          *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00247"></a>00247         }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249       <span class="comment">/*==============================================*/</span>
<a name="l00250"></a>00250       <span class="comment">/* Parse a salience declaration if encountered. */</span>
<a name="l00251"></a>00251       <span class="comment">/*==============================================*/</span>
<a name="l00252"></a>00252 
<a name="l00253"></a>00253       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"salience"</span>) == 0)
<a name="l00254"></a>00254         {
<a name="l00255"></a>00255          <span class="keywordflow">if</span> (salienceParsed)
<a name="l00256"></a>00256            {
<a name="l00257"></a>00257             <a class="code" href="prntutil_8c.html#66a79238b11157346ab82ac57c96494e">AlreadyParsedErrorMessage</a>(theEnv,<span class="stringliteral">"salience declaration"</span>,NULL);
<a name="l00258"></a>00258             *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00259"></a>00259            }
<a name="l00260"></a>00260          <span class="keywordflow">else</span>
<a name="l00261"></a>00261            {
<a name="l00262"></a>00262             ParseSalience(theEnv,readSource,ruleName,error);
<a name="l00263"></a>00263             salienceParsed = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00264"></a>00264            }
<a name="l00265"></a>00265         }
<a name="l00266"></a>00266 
<a name="l00267"></a>00267       <span class="comment">/*=================================================*/</span>
<a name="l00268"></a>00268       <span class="comment">/* Parse an auto-focus declaration if encountered. */</span>
<a name="l00269"></a>00269       <span class="comment">/* A global flag is used to indicate if the        */</span>
<a name="l00270"></a>00270       <span class="comment">/* auto-focus feature for a rule was parsed.       */</span>
<a name="l00271"></a>00271       <span class="comment">/*=================================================*/</span>
<a name="l00272"></a>00272 
<a name="l00273"></a>00273       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"auto-focus"</span>) == 0)
<a name="l00274"></a>00274         {
<a name="l00275"></a>00275          <span class="keywordflow">if</span> (autoFocusParsed)
<a name="l00276"></a>00276            {
<a name="l00277"></a>00277             <a class="code" href="prntutil_8c.html#66a79238b11157346ab82ac57c96494e">AlreadyParsedErrorMessage</a>(theEnv,<span class="stringliteral">"auto-focus declaration"</span>,NULL);
<a name="l00278"></a>00278             *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00279"></a>00279            }
<a name="l00280"></a>00280          <span class="keywordflow">else</span>
<a name="l00281"></a>00281            {
<a name="l00282"></a>00282             ParseAutoFocus(theEnv,readSource,error);
<a name="l00283"></a>00283             autoFocusParsed = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00284"></a>00284            }
<a name="l00285"></a>00285          }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287        <span class="comment">/*==========================================*/</span>
<a name="l00288"></a>00288        <span class="comment">/* Otherwise the symbol does not correspond */</span>
<a name="l00289"></a>00289        <span class="comment">/* to a valid rule property.                */</span>
<a name="l00290"></a>00290        <span class="comment">/*==========================================*/</span>
<a name="l00291"></a>00291 
<a name="l00292"></a>00292        <span class="keywordflow">else</span>
<a name="l00293"></a>00293         {
<a name="l00294"></a>00294          <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"declare statement"</span>);
<a name="l00295"></a>00295          *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00296"></a>00296         }
<a name="l00297"></a>00297 
<a name="l00298"></a>00298       <span class="comment">/*=====================================*/</span>
<a name="l00299"></a>00299       <span class="comment">/* Return if an error was encountered. */</span>
<a name="l00300"></a>00300       <span class="comment">/*=====================================*/</span>
<a name="l00301"></a>00301 
<a name="l00302"></a>00302       <span class="keywordflow">if</span> (*error)
<a name="l00303"></a>00303         {
<a name="l00304"></a>00304          <a class="code" href="expressn_8c.html#3b603498bfe0cfebe274e8402137a602">ReturnExpression</a>(theEnv,<a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression);
<a name="l00305"></a>00305          <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression = NULL;
<a name="l00306"></a>00306          <span class="keywordflow">return</span>;
<a name="l00307"></a>00307         }
<a name="l00308"></a>00308 
<a name="l00309"></a>00309       <span class="comment">/*=======================================*/</span>
<a name="l00310"></a>00310       <span class="comment">/* Both the salience and auto-focus rule */</span>
<a name="l00311"></a>00311       <span class="comment">/* properties are closed with a ')'.     */</span>
<a name="l00312"></a>00312       <span class="comment">/*=======================================*/</span>
<a name="l00313"></a>00313 
<a name="l00314"></a>00314       <a class="code" href="scanner_8c.html#e909573743f1f7fd3b00d28c96f6a7d3">GetToken</a>(theEnv,readSource,&amp;theToken);
<a name="l00315"></a>00315       <span class="keywordflow">if</span> (theToken.<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> != <a class="code" href="constant_8h.html#61df4d037757ddf4c87aaa6405438cb2">RPAREN</a>)
<a name="l00316"></a>00316         {
<a name="l00317"></a>00317          <a class="code" href="pprint_8c.html#75a1ee27916fd946d264b1f0e6f6abd0">PPBackup</a>(theEnv);
<a name="l00318"></a>00318          <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,<span class="stringliteral">" "</span>);
<a name="l00319"></a>00319          <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,theToken.<a class="code" href="structtoken.html#e3f4568ecf8d0af7b9bdc91c9508b05a">printForm</a>);
<a name="l00320"></a>00320          <a class="code" href="expressn_8c.html#3b603498bfe0cfebe274e8402137a602">ReturnExpression</a>(theEnv,<a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression);
<a name="l00321"></a>00321          <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression = NULL;
<a name="l00322"></a>00322          <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"declare statement"</span>);
<a name="l00323"></a>00323          *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00324"></a>00324          <span class="keywordflow">return</span>;
<a name="l00325"></a>00325         }
<a name="l00326"></a>00326 
<a name="l00327"></a>00327       <span class="comment">/*=============================================*/</span>
<a name="l00328"></a>00328       <span class="comment">/* The declare statement is closed with a ')'. */</span>
<a name="l00329"></a>00329       <span class="comment">/*=============================================*/</span>
<a name="l00330"></a>00330 
<a name="l00331"></a>00331       <a class="code" href="scanner_8c.html#e909573743f1f7fd3b00d28c96f6a7d3">GetToken</a>(theEnv,readSource,&amp;theToken);
<a name="l00332"></a>00332       <span class="keywordflow">if</span> (theToken.<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> == <a class="code" href="constant_8h.html#61df4d037757ddf4c87aaa6405438cb2">RPAREN</a>) notDone = <a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00333"></a>00333       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (theToken.<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> != <a class="code" href="constant_8h.html#be30756b10aa77b095a8737a0d0b63ef">LPAREN</a>)
<a name="l00334"></a>00334         {
<a name="l00335"></a>00335          <a class="code" href="expressn_8c.html#3b603498bfe0cfebe274e8402137a602">ReturnExpression</a>(theEnv,<a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression);
<a name="l00336"></a>00336          <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression = NULL;
<a name="l00337"></a>00337          <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"declare statement"</span>);
<a name="l00338"></a>00338          *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00339"></a>00339          <span class="keywordflow">return</span>;
<a name="l00340"></a>00340         }
<a name="l00341"></a>00341       <span class="keywordflow">else</span>
<a name="l00342"></a>00342         {
<a name="l00343"></a>00343          <a class="code" href="pprint_8c.html#75a1ee27916fd946d264b1f0e6f6abd0">PPBackup</a>(theEnv);
<a name="l00344"></a>00344          <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,<span class="stringliteral">" ("</span>);
<a name="l00345"></a>00345         }
<a name="l00346"></a>00346      }
<a name="l00347"></a>00347 
<a name="l00348"></a>00348    <span class="comment">/*==========================================*/</span>
<a name="l00349"></a>00349    <span class="comment">/* Return the value of the salience through */</span>
<a name="l00350"></a>00350    <span class="comment">/* the global variable SalienceExpression.  */</span>
<a name="l00351"></a>00351    <span class="comment">/*==========================================*/</span>
<a name="l00352"></a>00352 
<a name="l00353"></a>00353    packPtr = <a class="code" href="expressn_8c.html#c3034d79564c54561f09742a41e7edc4">PackExpression</a>(theEnv,<a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression);
<a name="l00354"></a>00354    <a class="code" href="expressn_8c.html#3b603498bfe0cfebe274e8402137a602">ReturnExpression</a>(theEnv,<a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression);
<a name="l00355"></a>00355    <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression = packPtr;
<a name="l00356"></a>00356    <span class="keywordflow">return</span>;
<a name="l00357"></a>00357   }
<a name="l00358"></a>00358 
<a name="l00359"></a>00359 <span class="comment">/************************************************************/</span>
<a name="l00360"></a>00360 <span class="comment">/* ParseSalience: Parses the rest of a defrule salience     */</span>
<a name="l00361"></a>00361 <span class="comment">/*   declaration once the salience keyword has been parsed. */</span>
<a name="l00362"></a>00362 <span class="comment">/************************************************************/</span>
<a name="l00363"></a>00363 <span class="keyword">static</span> <span class="keywordtype">void</span> ParseSalience(
<a name="l00364"></a>00364   <span class="keywordtype">void</span> *theEnv,
<a name="l00365"></a>00365   <span class="keywordtype">char</span> *readSource,
<a name="l00366"></a>00366   <span class="keywordtype">char</span> *ruleName,
<a name="l00367"></a>00367   <span class="keywordtype">int</span> *error)
<a name="l00368"></a>00368   {
<a name="l00369"></a>00369    <span class="keywordtype">int</span> salience;
<a name="l00370"></a>00370    <a class="code" href="structdataObject.html">DATA_OBJECT</a> salienceValue;
<a name="l00371"></a>00371 
<a name="l00372"></a>00372    <span class="comment">/*==============================*/</span>
<a name="l00373"></a>00373    <span class="comment">/* Get the salience expression. */</span>
<a name="l00374"></a>00374    <span class="comment">/*==============================*/</span>
<a name="l00375"></a>00375 
<a name="l00376"></a>00376    <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,<span class="stringliteral">" "</span>);
<a name="l00377"></a>00377 
<a name="l00378"></a>00378    <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression = <a class="code" href="exprnpsr_8c.html#c1bff73566acbbb2a275f16ad843b55d">ParseAtomOrExpression</a>(theEnv,readSource,NULL);
<a name="l00379"></a>00379    <span class="keywordflow">if</span> (<a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression == NULL)
<a name="l00380"></a>00380      {
<a name="l00381"></a>00381       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00382"></a>00382       <span class="keywordflow">return</span>;
<a name="l00383"></a>00383      }
<a name="l00384"></a>00384 
<a name="l00385"></a>00385    <span class="comment">/*============================================================*/</span>
<a name="l00386"></a>00386    <span class="comment">/* Evaluate the expression and determine if it is an integer. */</span>
<a name="l00387"></a>00387    <span class="comment">/*============================================================*/</span>
<a name="l00388"></a>00388 
<a name="l00389"></a>00389    <a class="code" href="evaluatn_8c.html#4838a1d558eaca9eb78fe6560ff7fb0f">SetEvaluationError</a>(theEnv,<a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>);
<a name="l00390"></a>00390    <span class="keywordflow">if</span> (<a class="code" href="evaluatn_8c.html#ebbee0425a8f547d2d5ed617aad7bf31">EvaluateExpression</a>(theEnv,<a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression,&amp;salienceValue))
<a name="l00391"></a>00391      {
<a name="l00392"></a>00392       <a class="code" href="prntutil_8c.html#ae7b5cde7e366ad9436656f9b6a0d626">SalienceInformationError</a>(theEnv,<span class="stringliteral">"defrule"</span>,ruleName);
<a name="l00393"></a>00393       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00394"></a>00394       <span class="keywordflow">return</span>;
<a name="l00395"></a>00395      }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397    <span class="keywordflow">if</span> (salienceValue.<a class="code" href="structdataObject.html#8fce8fcf0a4e230b3c928ffd1bff6444">type</a> != <a class="code" href="constant_8h.html#91d43eadec33c80149f92e5abf5df58c">INTEGER</a>)
<a name="l00398"></a>00398      {
<a name="l00399"></a>00399       <a class="code" href="prntutil_8c.html#03fee3cfaf0e2325e89d2ca999d388ab">SalienceNonIntegerError</a>(theEnv);
<a name="l00400"></a>00400       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00401"></a>00401       <span class="keywordflow">return</span>;
<a name="l00402"></a>00402      }
<a name="l00403"></a>00403 
<a name="l00404"></a>00404    <span class="comment">/*=======================================================*/</span>
<a name="l00405"></a>00405    <span class="comment">/* Salience number must be in the range -10000 to 10000. */</span>
<a name="l00406"></a>00406    <span class="comment">/*=======================================================*/</span>
<a name="l00407"></a>00407 
<a name="l00408"></a>00408    salience = (int) <a class="code" href="symbol_8h.html#d4eb50aa1e34f8607bf4fccff6a3497a">ValueToLong</a>(salienceValue.<a class="code" href="structdataObject.html#954e353f458ca7ef5156fd007876a661">value</a>);
<a name="l00409"></a>00409 
<a name="l00410"></a>00410    <span class="keywordflow">if</span> ((salience &gt; <a class="code" href="agenda_8h.html#6926a4f1c85c4db4e1d1c1aa3ed207f9">MAX_DEFRULE_SALIENCE</a>) || (salience &lt; <a class="code" href="agenda_8h.html#56ff3b8dd57d868da82f0aa0a043e1fe">MIN_DEFRULE_SALIENCE</a>))
<a name="l00411"></a>00411      {
<a name="l00412"></a>00412       <a class="code" href="prntutil_8c.html#442fb3a513e6dcbc082a224d7d14ad97">SalienceRangeError</a>(theEnv,<a class="code" href="agenda_8h.html#56ff3b8dd57d868da82f0aa0a043e1fe">MIN_DEFRULE_SALIENCE</a>,<a class="code" href="agenda_8h.html#6926a4f1c85c4db4e1d1c1aa3ed207f9">MAX_DEFRULE_SALIENCE</a>);
<a name="l00413"></a>00413       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00414"></a>00414       <span class="keywordflow">return</span>;
<a name="l00415"></a>00415      }
<a name="l00416"></a>00416 
<a name="l00417"></a>00417    <span class="comment">/*==========================================*/</span>
<a name="l00418"></a>00418    <span class="comment">/* If the expression is a constant integer, */</span>
<a name="l00419"></a>00419    <span class="comment">/* don't bother storing the expression.     */</span>
<a name="l00420"></a>00420    <span class="comment">/*==========================================*/</span>
<a name="l00421"></a>00421 
<a name="l00422"></a>00422    <span class="keywordflow">if</span> (<a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression-&gt;type == <a class="code" href="constant_8h.html#91d43eadec33c80149f92e5abf5df58c">INTEGER</a>)
<a name="l00423"></a>00423      {
<a name="l00424"></a>00424       <a class="code" href="expressn_8c.html#3b603498bfe0cfebe274e8402137a602">ReturnExpression</a>(theEnv,<a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression);
<a name="l00425"></a>00425       <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;SalienceExpression = NULL;
<a name="l00426"></a>00426      }
<a name="l00427"></a>00427 
<a name="l00428"></a>00428    <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;GlobalSalience = salience;
<a name="l00429"></a>00429   }
<a name="l00430"></a>00430 
<a name="l00431"></a>00431 <span class="comment">/**************************************************************/</span>
<a name="l00432"></a>00432 <span class="comment">/* ParseAutoFocus: Parses the rest of a defrule auto-focus    */</span>
<a name="l00433"></a>00433 <span class="comment">/*   declaration once the auto-focus keyword has been parsed. */</span>
<a name="l00434"></a>00434 <span class="comment">/**************************************************************/</span>
<a name="l00435"></a>00435 <span class="keyword">static</span> <span class="keywordtype">void</span> ParseAutoFocus(
<a name="l00436"></a>00436   <span class="keywordtype">void</span> *theEnv,
<a name="l00437"></a>00437   <span class="keywordtype">char</span> *readSource,
<a name="l00438"></a>00438   <span class="keywordtype">int</span> *error)
<a name="l00439"></a>00439   {
<a name="l00440"></a>00440    <span class="keyword">struct </span><a class="code" href="structtoken.html">token</a> theToken;
<a name="l00441"></a>00441 
<a name="l00442"></a>00442    <span class="comment">/*========================================*/</span>
<a name="l00443"></a>00443    <span class="comment">/* The auto-focus value must be a symbol. */</span>
<a name="l00444"></a>00444    <span class="comment">/*========================================*/</span>
<a name="l00445"></a>00445 
<a name="l00446"></a>00446    <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,<span class="stringliteral">" "</span>);
<a name="l00447"></a>00447 
<a name="l00448"></a>00448    <a class="code" href="scanner_8c.html#e909573743f1f7fd3b00d28c96f6a7d3">GetToken</a>(theEnv,readSource,&amp;theToken);
<a name="l00449"></a>00449    <span class="keywordflow">if</span> (theToken.<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> != <a class="code" href="constant_8h.html#5f9ae9ce6aa6f82108b260135b2e63a0">SYMBOL</a>)
<a name="l00450"></a>00450      {
<a name="l00451"></a>00451       <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"auto-focus statement"</span>);
<a name="l00452"></a>00452       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00453"></a>00453       <span class="keywordflow">return</span>;
<a name="l00454"></a>00454      }
<a name="l00455"></a>00455 
<a name="l00456"></a>00456    <span class="comment">/*====================================================*/</span>
<a name="l00457"></a>00457    <span class="comment">/* The auto-focus value must be either TRUE or FALSE. */</span>
<a name="l00458"></a>00458    <span class="comment">/* If a valid value is parsed, then set the value of  */</span>
<a name="l00459"></a>00459    <span class="comment">/* the global variable GlobalAutoFocus.               */</span>
<a name="l00460"></a>00460    <span class="comment">/*====================================================*/</span>
<a name="l00461"></a>00461 
<a name="l00462"></a>00462    <span class="keywordflow">if</span> (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"TRUE"</span>) == 0)
<a name="l00463"></a>00463      { <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;GlobalAutoFocus = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; }
<a name="l00464"></a>00464    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"FALSE"</span>) == 0)
<a name="l00465"></a>00465      { <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;GlobalAutoFocus = <a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>; }
<a name="l00466"></a>00466    <span class="keywordflow">else</span>
<a name="l00467"></a>00467      {
<a name="l00468"></a>00468       <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"auto-focus statement"</span>);
<a name="l00469"></a>00469       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00470"></a>00470      }
<a name="l00471"></a>00471   }
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 <span class="comment">/*****************************************************************/</span>
<a name="l00474"></a>00474 <span class="comment">/* LHSPattern: Parses a single conditional element found on the  */</span>
<a name="l00475"></a>00475 <span class="comment">/*   LHS of a rule. Conditonal element types include pattern CEs */</span>
<a name="l00476"></a>00476 <span class="comment">/*   (which may be assigned to a variable), test CEs, not CEs,   */</span>
<a name="l00477"></a>00477 <span class="comment">/*   logical CEs, and CEs, and or CEs.                           */</span>
<a name="l00478"></a>00478 <span class="comment">/*                                                               */</span>
<a name="l00479"></a>00479 <span class="comment">/* &lt;conditional-element&gt; ::= &lt;pattern-CE&gt; |                      */</span>
<a name="l00480"></a>00480 <span class="comment">/*                           &lt;assigned-pattern-CE&gt; |             */</span>
<a name="l00481"></a>00481 <span class="comment">/*                           &lt;not-CE&gt; | &lt;and-CE&gt; | &lt;or-CE&gt; |     */</span>
<a name="l00482"></a>00482 <span class="comment">/*                           &lt;logical-CE&gt; | &lt;test-CE&gt; |          */</span>
<a name="l00483"></a>00483 <span class="comment">/*                           &lt;forall-CE&gt; | &lt;exists-CE&gt;           */</span>
<a name="l00484"></a>00484 <span class="comment">/*****************************************************************/</span>
<a name="l00485"></a>00485 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *LHSPattern(
<a name="l00486"></a>00486   <span class="keywordtype">void</span> *theEnv,
<a name="l00487"></a>00487   <span class="keywordtype">char</span> *readSource,
<a name="l00488"></a>00488   <span class="keywordtype">int</span> terminator,
<a name="l00489"></a>00489   <span class="keywordtype">char</span> *terminatorString,
<a name="l00490"></a>00490   <span class="keywordtype">int</span> *error,
<a name="l00491"></a>00491   <span class="keywordtype">int</span> allowDeclaration,
<a name="l00492"></a>00492   <span class="keyword">struct</span> <a class="code" href="structtoken.html">token</a> *firstToken,
<a name="l00493"></a>00493   <span class="keywordtype">char</span> *ruleName)
<a name="l00494"></a>00494   {
<a name="l00495"></a>00495    <span class="keyword">struct </span><a class="code" href="structtoken.html">token</a> theToken;
<a name="l00496"></a>00496    <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *theNode;
<a name="l00497"></a>00497 
<a name="l00498"></a>00498    <span class="comment">/*=========================================================*/</span>
<a name="l00499"></a>00499    <span class="comment">/* Check to see if the first token has already been read.  */</span>
<a name="l00500"></a>00500    <span class="comment">/* This should only occur for the first pattern in a rule. */</span>
<a name="l00501"></a>00501    <span class="comment">/*=========================================================*/</span>
<a name="l00502"></a>00502 
<a name="l00503"></a>00503    <span class="keywordflow">if</span> (firstToken == NULL) <a class="code" href="scanner_8c.html#e909573743f1f7fd3b00d28c96f6a7d3">GetToken</a>(theEnv,readSource,&amp;theToken);
<a name="l00504"></a>00504    <span class="keywordflow">else</span> <a class="code" href="scanner_8c.html#b63a6948079bb4428b53944689aab586">CopyToken</a>(&amp;theToken,firstToken);
<a name="l00505"></a>00505 
<a name="l00506"></a>00506    <span class="comment">/*=====================================================*/</span>
<a name="l00507"></a>00507    <span class="comment">/* A left parenthesis begins all CEs and declarations. */</span>
<a name="l00508"></a>00508    <span class="comment">/*=====================================================*/</span>
<a name="l00509"></a>00509 
<a name="l00510"></a>00510    <span class="keywordflow">if</span> (theToken.<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> == <a class="code" href="constant_8h.html#be30756b10aa77b095a8737a0d0b63ef">LPAREN</a>)
<a name="l00511"></a>00511      {
<a name="l00512"></a>00512       <span class="comment">/*================================================*/</span>
<a name="l00513"></a>00513       <span class="comment">/* The first field of a pattern must be a symbol. */</span>
<a name="l00514"></a>00514       <span class="comment">/*================================================*/</span>
<a name="l00515"></a>00515 
<a name="l00516"></a>00516       <a class="code" href="scanner_8c.html#e909573743f1f7fd3b00d28c96f6a7d3">GetToken</a>(theEnv,readSource,&amp;theToken);
<a name="l00517"></a>00517       <span class="keywordflow">if</span> (theToken.<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> != <a class="code" href="constant_8h.html#5f9ae9ce6aa6f82108b260135b2e63a0">SYMBOL</a>)
<a name="l00518"></a>00518         {
<a name="l00519"></a>00519          <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"the first field of a pattern"</span>);
<a name="l00520"></a>00520          *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00521"></a>00521          <span class="keywordflow">return</span>(NULL);
<a name="l00522"></a>00522         }
<a name="l00523"></a>00523 
<a name="l00524"></a>00524       <span class="comment">/*====================================*/</span>
<a name="l00525"></a>00525       <span class="comment">/* If this is the first CE of a rule, */</span>
<a name="l00526"></a>00526       <span class="comment">/* then a declare statement is valid. */</span>
<a name="l00527"></a>00527       <span class="comment">/*====================================*/</span>
<a name="l00528"></a>00528 
<a name="l00529"></a>00529       <span class="keywordflow">if</span> (allowDeclaration &amp;&amp;
<a name="l00530"></a>00530           (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"declare"</span>) == 0))
<a name="l00531"></a>00531         {
<a name="l00532"></a>00532          <span class="keywordflow">if</span> (ruleName == NULL) <a class="code" href="prntutil_8c.html#66a7b5e591175f2451b6851bc39205a8">SystemError</a>(theEnv,<span class="stringliteral">"RULELHS"</span>,1);
<a name="l00533"></a>00533          DeclarationParse(theEnv,readSource,ruleName,error);
<a name="l00534"></a>00534          theNode = NULL;
<a name="l00535"></a>00535         }
<a name="l00536"></a>00536 
<a name="l00537"></a>00537       <span class="comment">/*==================================*/</span>
<a name="l00538"></a>00538       <span class="comment">/* Otherwise check for a *test* CE. */</span>
<a name="l00539"></a>00539       <span class="comment">/*==================================*/</span>
<a name="l00540"></a>00540 
<a name="l00541"></a>00541       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"test"</span>) == 0)
<a name="l00542"></a>00542         { theNode = TestPattern(theEnv,readSource,error); }
<a name="l00543"></a>00543 
<a name="l00544"></a>00544       <span class="comment">/*============================================*/</span>
<a name="l00545"></a>00545       <span class="comment">/* Otherwise check for an *and*, *or*, *not*, */</span>
<a name="l00546"></a>00546       <span class="comment">/* *logical*, *exists*, or *forall* CE.       */</span>
<a name="l00547"></a>00547       <span class="comment">/*============================================*/</span>
<a name="l00548"></a>00548 
<a name="l00549"></a>00549       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"and"</span>) == 0) ||
<a name="l00550"></a>00550                (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"logical"</span>) == 0) ||
<a name="l00551"></a>00551                (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"not"</span>) == 0) ||
<a name="l00552"></a>00552                (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"exists"</span>) == 0) ||
<a name="l00553"></a>00553                (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"forall"</span>) == 0) ||
<a name="l00554"></a>00554                (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"or"</span>) == 0))
<a name="l00555"></a>00555         { theNode = ConnectedPatternParse(theEnv,readSource,&amp;theToken,error); }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557       <span class="comment">/*=================================*/</span>
<a name="l00558"></a>00558       <span class="comment">/* Otherwise parse a *pattern* CE. */</span>
<a name="l00559"></a>00559       <span class="comment">/*=================================*/</span>
<a name="l00560"></a>00560 
<a name="l00561"></a>00561       <span class="keywordflow">else</span>
<a name="l00562"></a>00562         { theNode = SimplePatternParse(theEnv,readSource,&amp;theToken,error); }
<a name="l00563"></a>00563      }
<a name="l00564"></a>00564 
<a name="l00565"></a>00565    <span class="comment">/*=======================================*/</span>
<a name="l00566"></a>00566    <span class="comment">/* Check for a pattern address variable. */</span>
<a name="l00567"></a>00567    <span class="comment">/*=======================================*/</span>
<a name="l00568"></a>00568 
<a name="l00569"></a>00569    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (theToken.<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> == <a class="code" href="constant_8h.html#e3409262e1e4369e9ab78eadaba29859">SF_VARIABLE</a>)
<a name="l00570"></a>00570      { theNode = AssignmentParse(theEnv,readSource,(<a class="code" href="structsymbolHashNode.html">SYMBOL_HN</a> *) theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>,error); }
<a name="l00571"></a>00571 
<a name="l00572"></a>00572    <span class="comment">/*=================================================*/</span>
<a name="l00573"></a>00573    <span class="comment">/* Check for the group terminator (either a "=&gt;"   */</span>
<a name="l00574"></a>00574    <span class="comment">/* separating the LHS from the RHS or a ")" ending */</span>
<a name="l00575"></a>00575    <span class="comment">/* a CE containing other CEs such as an *and* CE). */</span>
<a name="l00576"></a>00576    <span class="comment">/*=================================================*/</span>
<a name="l00577"></a>00577 
<a name="l00578"></a>00578    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((theToken.<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> == terminator) ?
<a name="l00579"></a>00579             (strcmp(theToken.<a class="code" href="structtoken.html#e3f4568ecf8d0af7b9bdc91c9508b05a">printForm</a>,terminatorString) == 0) : <a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l00580"></a>00580      { <span class="keywordflow">return</span>(NULL);  }
<a name="l00581"></a>00581 
<a name="l00582"></a>00582    <span class="comment">/*====================================*/</span>
<a name="l00583"></a>00583    <span class="comment">/* Otherwise invalid syntax was used. */</span>
<a name="l00584"></a>00584    <span class="comment">/*====================================*/</span>
<a name="l00585"></a>00585 
<a name="l00586"></a>00586    <span class="keywordflow">else</span>
<a name="l00587"></a>00587      {
<a name="l00588"></a>00588       <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"defrule"</span>);
<a name="l00589"></a>00589       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00590"></a>00590       <span class="keywordflow">return</span>(NULL);
<a name="l00591"></a>00591      }
<a name="l00592"></a>00592 
<a name="l00593"></a>00593    <span class="comment">/*================================*/</span>
<a name="l00594"></a>00594    <span class="comment">/* If an error occurred, free any */</span>
<a name="l00595"></a>00595    <span class="comment">/* allocated data structures.     */</span>
<a name="l00596"></a>00596    <span class="comment">/*================================*/</span>
<a name="l00597"></a>00597 
<a name="l00598"></a>00598    <span class="keywordflow">if</span> (*error == <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l00599"></a>00599      {
<a name="l00600"></a>00600       <a class="code" href="reorder_8c.html#36adfa94188ac9a3092e8a19d19312c9">ReturnLHSParseNodes</a>(theEnv,theNode);
<a name="l00601"></a>00601       <span class="keywordflow">return</span>(NULL);
<a name="l00602"></a>00602      }
<a name="l00603"></a>00603 
<a name="l00604"></a>00604    <span class="comment">/*=========================*/</span>
<a name="l00605"></a>00605    <span class="comment">/* Return the LHS pattern. */</span>
<a name="l00606"></a>00606    <span class="comment">/*=========================*/</span>
<a name="l00607"></a>00607 
<a name="l00608"></a>00608    <span class="keywordflow">return</span>(theNode);
<a name="l00609"></a>00609   }
<a name="l00610"></a>00610 
<a name="l00611"></a>00611 <span class="comment">/*********************************************************************/</span>
<a name="l00612"></a>00612 <span class="comment">/* ConnectedPatternParse:  Handles parsing of the connected          */</span>
<a name="l00613"></a>00613 <span class="comment">/*   conditional elements (i.e. those conditional elements that may  */</span>
<a name="l00614"></a>00614 <span class="comment">/*   contain one or more other conditional elements).  The connected */</span>
<a name="l00615"></a>00615 <span class="comment">/*   conditional elements include the *and*, *or*, *not*, *logical*, */</span>
<a name="l00616"></a>00616 <span class="comment">/*   *exists*, and *forall* CEs. This routine is entered with the    */</span>
<a name="l00617"></a>00617 <span class="comment">/*   parsing pointing to the name of the connected CE. It is exited  */</span>
<a name="l00618"></a>00618 <span class="comment">/*   with the parser pointing to the closing right parenthesis of    */</span>
<a name="l00619"></a>00619 <span class="comment">/*   the connected CE.                                               */</span>
<a name="l00620"></a>00620 <span class="comment">/*                                                                   */</span>
<a name="l00621"></a>00621 <span class="comment">/* &lt;and-CE&gt;      ::= (and &lt;conditional-element&gt;+)                    */</span>
<a name="l00622"></a>00622 <span class="comment">/*                                                                   */</span>
<a name="l00623"></a>00623 <span class="comment">/* &lt;or-CE&gt;       ::= (or &lt;conditional-element&gt;+)                     */</span>
<a name="l00624"></a>00624 <span class="comment">/*                                                                   */</span>
<a name="l00625"></a>00625 <span class="comment">/* &lt;logical-CE&gt;  ::= (logical &lt;conditional-element&gt;+)                */</span>
<a name="l00626"></a>00626 <span class="comment">/*                                                                   */</span>
<a name="l00627"></a>00627 <span class="comment">/* &lt;not-CE&gt;      ::= (not &lt;conditional-element&gt;)                     */</span>
<a name="l00628"></a>00628 <span class="comment">/*                                                                   */</span>
<a name="l00629"></a>00629 <span class="comment">/* &lt;exists-CE&gt;   ::= (exists &lt;conditional-element&gt;+)                 */</span>
<a name="l00630"></a>00630 <span class="comment">/*                                                                   */</span>
<a name="l00631"></a>00631 <span class="comment">/* &lt;forall-CE&gt;   ::= (forall &lt;conditional-element&gt;                   */</span>
<a name="l00632"></a>00632 <span class="comment">/*                           &lt;conditional-element&gt;+)                 */</span>
<a name="l00633"></a>00633 <span class="comment">/*********************************************************************/</span>
<a name="l00634"></a>00634 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *ConnectedPatternParse(
<a name="l00635"></a>00635   <span class="keywordtype">void</span> *theEnv,
<a name="l00636"></a>00636   <span class="keywordtype">char</span> *readSource,
<a name="l00637"></a>00637   <span class="keyword">struct</span> <a class="code" href="structtoken.html">token</a> *theToken,
<a name="l00638"></a>00638   <span class="keywordtype">int</span> *error)
<a name="l00639"></a>00639   {
<a name="l00640"></a>00640    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> connectorValue = 0;
<a name="l00641"></a>00641    <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *theNode, *tempNode, *theGroup;
<a name="l00642"></a>00642    <span class="keywordtype">char</span> *errorCE = NULL;
<a name="l00643"></a>00643    <span class="keywordtype">int</span> <a class="code" href="structlhsParseNode.html#c38564da23a2a836bbce6cd2fcc1b761">logical</a> = <a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00644"></a>00644    <span class="keywordtype">int</span> tempValue;
<a name="l00645"></a>00645 
<a name="l00646"></a>00646    <span class="comment">/*==========================================================*/</span>
<a name="l00647"></a>00647    <span class="comment">/* Use appropriate spacing for pretty printing of the rule. */</span>
<a name="l00648"></a>00648    <span class="comment">/*==========================================================*/</span>
<a name="l00649"></a>00649 
<a name="l00650"></a>00650    <a class="code" href="pprint_8c.html#b26739ae4aa4c0f8bdc2db057844aa06">IncrementIndentDepth</a>(theEnv,5);
<a name="l00651"></a>00651    <span class="keywordflow">if</span> (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken-&gt;<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"or"</span>) == 0)
<a name="l00652"></a>00652      {
<a name="l00653"></a>00653       connectorValue = <a class="code" href="constant_8h.html#515f3141cc703d99b725cd1f8dd18265">OR_CE</a>;
<a name="l00654"></a>00654       errorCE = <span class="stringliteral">"the or conditional element"</span>;
<a name="l00655"></a>00655       <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,<span class="stringliteral">"  "</span>);
<a name="l00656"></a>00656      }
<a name="l00657"></a>00657    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken-&gt;<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"and"</span>) == 0)
<a name="l00658"></a>00658      {
<a name="l00659"></a>00659       connectorValue = <a class="code" href="constant_8h.html#308e894d9961d36b503cb11f28f8aa8e">AND_CE</a>;
<a name="l00660"></a>00660       errorCE = <span class="stringliteral">"the and conditional element"</span>;
<a name="l00661"></a>00661       <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,<span class="stringliteral">" "</span>);
<a name="l00662"></a>00662      }
<a name="l00663"></a>00663    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken-&gt;<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"not"</span>) == 0)
<a name="l00664"></a>00664      {
<a name="l00665"></a>00665       connectorValue = <a class="code" href="constant_8h.html#0ad99db1679eed3eea9341cc242e83d8">NOT_CE</a>;
<a name="l00666"></a>00666       errorCE = <span class="stringliteral">"the not conditional element"</span>;
<a name="l00667"></a>00667       <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,<span class="stringliteral">" "</span>);
<a name="l00668"></a>00668      }
<a name="l00669"></a>00669    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken-&gt;<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"exists"</span>) == 0)
<a name="l00670"></a>00670      {
<a name="l00671"></a>00671       connectorValue = <a class="code" href="constant_8h.html#19903c3ec9494417b0e7a423fef3185a">EXISTS_CE</a>;
<a name="l00672"></a>00672       errorCE = <span class="stringliteral">"the exists conditional element"</span>;
<a name="l00673"></a>00673       <a class="code" href="pprint_8c.html#5e134cd66ac894adf35c7e385aec86ea">PPCRAndIndent</a>(theEnv);
<a name="l00674"></a>00674      }
<a name="l00675"></a>00675    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken-&gt;<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"forall"</span>) == 0)
<a name="l00676"></a>00676      {
<a name="l00677"></a>00677       connectorValue = <a class="code" href="constant_8h.html#f046d4eca46e78e46da0eb0df183666f">FORALL_CE</a>;
<a name="l00678"></a>00678       errorCE = <span class="stringliteral">"the forall conditional element"</span>;
<a name="l00679"></a>00679       <a class="code" href="pprint_8c.html#5e134cd66ac894adf35c7e385aec86ea">PPCRAndIndent</a>(theEnv);
<a name="l00680"></a>00680      }
<a name="l00681"></a>00681    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken-&gt;<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"logical"</span>) == 0)
<a name="l00682"></a>00682      {
<a name="l00683"></a>00683       connectorValue = <a class="code" href="constant_8h.html#308e894d9961d36b503cb11f28f8aa8e">AND_CE</a>;
<a name="l00684"></a>00684       errorCE = <span class="stringliteral">"the logical conditional element"</span>;
<a name="l00685"></a>00685       logical = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00686"></a>00686       <a class="code" href="pprint_8c.html#5e134cd66ac894adf35c7e385aec86ea">PPCRAndIndent</a>(theEnv);
<a name="l00687"></a>00687      }
<a name="l00688"></a>00688 
<a name="l00689"></a>00689    <span class="comment">/*=====================================================*/</span>
<a name="l00690"></a>00690    <span class="comment">/* The logical CE cannot be contained within a not CE. */</span>
<a name="l00691"></a>00691    <span class="comment">/*=====================================================*/</span>
<a name="l00692"></a>00692 
<a name="l00693"></a>00693    <span class="keywordflow">if</span> (<a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;WithinNotCE &amp;&amp; logical)
<a name="l00694"></a>00694      {
<a name="l00695"></a>00695       <a class="code" href="prntutil_8c.html#fbf692a39a683a2f1bd16185a376ae4e">PrintErrorID</a>(theEnv,<span class="stringliteral">"RULELHS"</span>,1,<a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l00696"></a>00696       <a class="code" href="router_8c.html#b440fbdc73d01def2c24bc96adbf4aeb">EnvPrintRouter</a>(theEnv,<a class="code" href="router_8h.html#bdc841279c3796079bf651d161b136cc">WERROR</a>,<span class="stringliteral">"The logical CE cannot be used within a not/exists/forall CE.\n"</span>);
<a name="l00697"></a>00697       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00698"></a>00698       <span class="keywordflow">return</span>(NULL);
<a name="l00699"></a>00699      }
<a name="l00700"></a>00700 
<a name="l00701"></a>00701    <span class="comment">/*=====================================================*/</span>
<a name="l00702"></a>00702    <span class="comment">/* Remember if we're currently within a *not* CE and   */</span>
<a name="l00703"></a>00703    <span class="comment">/* then check to see if we're entering a new *not* CE. */</span>
<a name="l00704"></a>00704    <span class="comment">/*=====================================================*/</span>
<a name="l00705"></a>00705 
<a name="l00706"></a>00706       tempValue = <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;WithinNotCE;
<a name="l00707"></a>00707    <span class="keywordflow">if</span> ((connectorValue == <a class="code" href="constant_8h.html#0ad99db1679eed3eea9341cc242e83d8">NOT_CE</a>) ||
<a name="l00708"></a>00708        (connectorValue == <a class="code" href="constant_8h.html#19903c3ec9494417b0e7a423fef3185a">EXISTS_CE</a>) ||
<a name="l00709"></a>00709        (connectorValue == <a class="code" href="constant_8h.html#f046d4eca46e78e46da0eb0df183666f">FORALL_CE</a>))
<a name="l00710"></a>00710      { <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;WithinNotCE = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>; }
<a name="l00711"></a>00711 
<a name="l00712"></a>00712    <span class="comment">/*===========================================*/</span>
<a name="l00713"></a>00713    <span class="comment">/* Parse all of the CEs contained with the   */</span>
<a name="l00714"></a>00714    <span class="comment">/* CE. A ) will terminate the end of the CE. */</span>
<a name="l00715"></a>00715    <span class="comment">/*===========================================*/</span>
<a name="l00716"></a>00716 
<a name="l00717"></a>00717    theGroup = GroupPatterns(theEnv,readSource,<a class="code" href="constant_8h.html#61df4d037757ddf4c87aaa6405438cb2">RPAREN</a>,<span class="stringliteral">")"</span>,error);
<a name="l00718"></a>00718 
<a name="l00719"></a>00719    <span class="comment">/*====================================*/</span>
<a name="l00720"></a>00720    <span class="comment">/* Restore the "with a *not* CE" flag */</span>
<a name="l00721"></a>00721    <span class="comment">/* and reset the indentation depth.   */</span>
<a name="l00722"></a>00722    <span class="comment">/*====================================*/</span>
<a name="l00723"></a>00723 
<a name="l00724"></a>00724    <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;WithinNotCE = tempValue;
<a name="l00725"></a>00725    <a class="code" href="pprint_8c.html#9f005187c4974cb94e9480f1ce96164f">DecrementIndentDepth</a>(theEnv,5);
<a name="l00726"></a>00726 
<a name="l00727"></a>00727    <span class="comment">/*============================================*/</span>
<a name="l00728"></a>00728    <span class="comment">/* If an error occured while parsing, return. */</span>
<a name="l00729"></a>00729    <span class="comment">/*============================================*/</span>
<a name="l00730"></a>00730 
<a name="l00731"></a>00731    <span class="keywordflow">if</span> (*error == <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l00732"></a>00732      {
<a name="l00733"></a>00733       <a class="code" href="reorder_8c.html#36adfa94188ac9a3092e8a19d19312c9">ReturnLHSParseNodes</a>(theEnv,theGroup);
<a name="l00734"></a>00734       <span class="keywordflow">return</span>(NULL);
<a name="l00735"></a>00735      }
<a name="l00736"></a>00736 
<a name="l00737"></a>00737    <span class="comment">/*=========================================================*/</span>
<a name="l00738"></a>00738    <span class="comment">/* If we parsed a *logical* CE, then mark the logical flag */</span>
<a name="l00739"></a>00739    <span class="comment">/* for all of the CEs contained within the logical CE.     */</span>
<a name="l00740"></a>00740    <span class="comment">/*=========================================================*/</span>
<a name="l00741"></a>00741 
<a name="l00742"></a>00742    <span class="keywordflow">if</span> (logical) TagLHSLogicalNodes(theGroup);
<a name="l00743"></a>00743 
<a name="l00744"></a>00744    <span class="comment">/*=====================================================*/</span>
<a name="l00745"></a>00745    <span class="comment">/* All the connected CEs must contain at least one CE. */</span>
<a name="l00746"></a>00746    <span class="comment">/*=====================================================*/</span>
<a name="l00747"></a>00747 
<a name="l00748"></a>00748    <span class="keywordflow">if</span> (theGroup == NULL)
<a name="l00749"></a>00749      {
<a name="l00750"></a>00750       <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,errorCE);
<a name="l00751"></a>00751       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00752"></a>00752       <span class="keywordflow">return</span>(NULL);
<a name="l00753"></a>00753      }
<a name="l00754"></a>00754 
<a name="l00755"></a>00755    <span class="comment">/*============================================*/</span>
<a name="l00756"></a>00756    <span class="comment">/* A not CE may not contain more than one CE. */</span>
<a name="l00757"></a>00757    <span class="comment">/*============================================*/</span>
<a name="l00758"></a>00758 
<a name="l00759"></a>00759    <span class="keywordflow">if</span> ((connectorValue == <a class="code" href="constant_8h.html#0ad99db1679eed3eea9341cc242e83d8">NOT_CE</a>) &amp;&amp; (theGroup-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a> != NULL))
<a name="l00760"></a>00760      {
<a name="l00761"></a>00761       <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,errorCE);
<a name="l00762"></a>00762       <a class="code" href="reorder_8c.html#36adfa94188ac9a3092e8a19d19312c9">ReturnLHSParseNodes</a>(theEnv,theGroup);
<a name="l00763"></a>00763       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00764"></a>00764       <span class="keywordflow">return</span>(NULL);
<a name="l00765"></a>00765      }
<a name="l00766"></a>00766 
<a name="l00767"></a>00767    <span class="comment">/*============================================*/</span>
<a name="l00768"></a>00768    <span class="comment">/* A forall CE must contain at least two CEs. */</span>
<a name="l00769"></a>00769    <span class="comment">/*============================================*/</span>
<a name="l00770"></a>00770 
<a name="l00771"></a>00771    <span class="keywordflow">if</span> ((connectorValue == <a class="code" href="constant_8h.html#f046d4eca46e78e46da0eb0df183666f">FORALL_CE</a>) &amp;&amp; (theGroup-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a> == NULL))
<a name="l00772"></a>00772      {
<a name="l00773"></a>00773       <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,errorCE);
<a name="l00774"></a>00774       <a class="code" href="reorder_8c.html#36adfa94188ac9a3092e8a19d19312c9">ReturnLHSParseNodes</a>(theEnv,theGroup);
<a name="l00775"></a>00775       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00776"></a>00776       <span class="keywordflow">return</span>(NULL);
<a name="l00777"></a>00777      }
<a name="l00778"></a>00778 
<a name="l00779"></a>00779    <span class="comment">/*========================================================*/</span>
<a name="l00780"></a>00780    <span class="comment">/* Remove an "and" and "or" CE that only contains one CE. */</span>
<a name="l00781"></a>00781    <span class="comment">/*========================================================*/</span>
<a name="l00782"></a>00782 
<a name="l00783"></a>00783    <span class="keywordflow">if</span> (((connectorValue == <a class="code" href="constant_8h.html#308e894d9961d36b503cb11f28f8aa8e">AND_CE</a>) || (connectorValue == <a class="code" href="constant_8h.html#515f3141cc703d99b725cd1f8dd18265">OR_CE</a>)) &amp;&amp;
<a name="l00784"></a>00784        (theGroup-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a> == NULL))
<a name="l00785"></a>00785      {
<a name="l00786"></a>00786       theGroup-&gt;<a class="code" href="structlhsParseNode.html#c38564da23a2a836bbce6cd2fcc1b761">logical</a> = logical;
<a name="l00787"></a>00787       <span class="keywordflow">return</span>(theGroup);
<a name="l00788"></a>00788      }
<a name="l00789"></a>00789 
<a name="l00790"></a>00790    <span class="comment">/*===========================================================*/</span>
<a name="l00791"></a>00791    <span class="comment">/* Create the top most node which connects the CEs together. */</span>
<a name="l00792"></a>00792    <span class="comment">/*===========================================================*/</span>
<a name="l00793"></a>00793 
<a name="l00794"></a>00794    theNode = <a class="code" href="reorder_8c.html#cd64b0e53ce385e6e9233008738e1d6a">GetLHSParseNode</a>(theEnv);
<a name="l00795"></a>00795    theNode-&gt;<a class="code" href="structlhsParseNode.html#c38564da23a2a836bbce6cd2fcc1b761">logical</a> = logical;
<a name="l00796"></a>00796 
<a name="l00797"></a>00797    <span class="comment">/*======================================================*/</span>
<a name="l00798"></a>00798    <span class="comment">/* Attach and/or/not CEs directly to the top most node. */</span>
<a name="l00799"></a>00799    <span class="comment">/*======================================================*/</span>
<a name="l00800"></a>00800 
<a name="l00801"></a>00801    <span class="keywordflow">if</span> ((connectorValue == <a class="code" href="constant_8h.html#308e894d9961d36b503cb11f28f8aa8e">AND_CE</a>) ||
<a name="l00802"></a>00802        (connectorValue == <a class="code" href="constant_8h.html#515f3141cc703d99b725cd1f8dd18265">OR_CE</a>) ||
<a name="l00803"></a>00803        (connectorValue == <a class="code" href="constant_8h.html#0ad99db1679eed3eea9341cc242e83d8">NOT_CE</a>))
<a name="l00804"></a>00804      {
<a name="l00805"></a>00805       theNode-&gt;<a class="code" href="structlhsParseNode.html#adbe273c2b99dc5e32295b70ecc5a102">type</a> = connectorValue;
<a name="l00806"></a>00806       theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a> = theGroup;
<a name="l00807"></a>00807      }
<a name="l00808"></a>00808 
<a name="l00809"></a>00809    <span class="comment">/*=================================================================*/</span>
<a name="l00810"></a>00810    <span class="comment">/* Wrap two not CEs around the patterns contained in an exists CE. */</span>
<a name="l00811"></a>00811    <span class="comment">/*=================================================================*/</span>
<a name="l00812"></a>00812 
<a name="l00813"></a>00813    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (connectorValue == <a class="code" href="constant_8h.html#19903c3ec9494417b0e7a423fef3185a">EXISTS_CE</a>)
<a name="l00814"></a>00814      {
<a name="l00815"></a>00815       theNode-&gt;<a class="code" href="structlhsParseNode.html#adbe273c2b99dc5e32295b70ecc5a102">type</a> = <a class="code" href="constant_8h.html#0ad99db1679eed3eea9341cc242e83d8">NOT_CE</a>;
<a name="l00816"></a>00816 
<a name="l00817"></a>00817       theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a> = <a class="code" href="reorder_8c.html#cd64b0e53ce385e6e9233008738e1d6a">GetLHSParseNode</a>(theEnv);
<a name="l00818"></a>00818       theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#adbe273c2b99dc5e32295b70ecc5a102">type</a> = <a class="code" href="constant_8h.html#0ad99db1679eed3eea9341cc242e83d8">NOT_CE</a>;
<a name="l00819"></a>00819       theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#c38564da23a2a836bbce6cd2fcc1b761">logical</a> = logical;
<a name="l00820"></a>00820 
<a name="l00821"></a>00821       <span class="keywordflow">if</span> (theGroup-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a> != NULL)
<a name="l00822"></a>00822         {
<a name="l00823"></a>00823          theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a> = <a class="code" href="reorder_8c.html#cd64b0e53ce385e6e9233008738e1d6a">GetLHSParseNode</a>(theEnv);
<a name="l00824"></a>00824          theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#adbe273c2b99dc5e32295b70ecc5a102">type</a> = <a class="code" href="constant_8h.html#308e894d9961d36b503cb11f28f8aa8e">AND_CE</a>;
<a name="l00825"></a>00825          theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#c38564da23a2a836bbce6cd2fcc1b761">logical</a> = logical;
<a name="l00826"></a>00826          theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a> = theGroup;
<a name="l00827"></a>00827         }
<a name="l00828"></a>00828       <span class="keywordflow">else</span>
<a name="l00829"></a>00829         { theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a> = theGroup; }
<a name="l00830"></a>00830      }
<a name="l00831"></a>00831 
<a name="l00832"></a>00832    <span class="comment">/*==================================================*/</span>
<a name="l00833"></a>00833    <span class="comment">/* For a forall CE, wrap a not CE around all of the */</span>
<a name="l00834"></a>00834    <span class="comment">/* CEs and a not CE around the 2nd through nth CEs. */</span>
<a name="l00835"></a>00835    <span class="comment">/*==================================================*/</span>
<a name="l00836"></a>00836 
<a name="l00837"></a>00837    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (connectorValue == <a class="code" href="constant_8h.html#f046d4eca46e78e46da0eb0df183666f">FORALL_CE</a>)
<a name="l00838"></a>00838      {
<a name="l00839"></a>00839       theNode-&gt;<a class="code" href="structlhsParseNode.html#adbe273c2b99dc5e32295b70ecc5a102">type</a> = <a class="code" href="constant_8h.html#0ad99db1679eed3eea9341cc242e83d8">NOT_CE</a>;
<a name="l00840"></a>00840 
<a name="l00841"></a>00841       tempNode = theGroup-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a>;
<a name="l00842"></a>00842       theGroup-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a> = NULL;
<a name="l00843"></a>00843 
<a name="l00844"></a>00844       theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a> = <a class="code" href="reorder_8c.html#cd64b0e53ce385e6e9233008738e1d6a">GetLHSParseNode</a>(theEnv);
<a name="l00845"></a>00845       theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#adbe273c2b99dc5e32295b70ecc5a102">type</a> = <a class="code" href="constant_8h.html#308e894d9961d36b503cb11f28f8aa8e">AND_CE</a>;
<a name="l00846"></a>00846       theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#c38564da23a2a836bbce6cd2fcc1b761">logical</a> = logical;
<a name="l00847"></a>00847       theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a> = theGroup;
<a name="l00848"></a>00848 
<a name="l00849"></a>00849       theGroup = tempNode;
<a name="l00850"></a>00850 
<a name="l00851"></a>00851       theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a> = <a class="code" href="reorder_8c.html#cd64b0e53ce385e6e9233008738e1d6a">GetLHSParseNode</a>(theEnv);
<a name="l00852"></a>00852       theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a>-&gt;<a class="code" href="structlhsParseNode.html#adbe273c2b99dc5e32295b70ecc5a102">type</a> = <a class="code" href="constant_8h.html#0ad99db1679eed3eea9341cc242e83d8">NOT_CE</a>;
<a name="l00853"></a>00853       theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a>-&gt;<a class="code" href="structlhsParseNode.html#c38564da23a2a836bbce6cd2fcc1b761">logical</a> = logical;
<a name="l00854"></a>00854 
<a name="l00855"></a>00855       tempNode = theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a>;
<a name="l00856"></a>00856 
<a name="l00857"></a>00857       <span class="keywordflow">if</span> (theGroup-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a> == NULL)
<a name="l00858"></a>00858         { tempNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a> = theGroup; }
<a name="l00859"></a>00859       <span class="keywordflow">else</span>
<a name="l00860"></a>00860         {
<a name="l00861"></a>00861          tempNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a> = <a class="code" href="reorder_8c.html#cd64b0e53ce385e6e9233008738e1d6a">GetLHSParseNode</a>(theEnv);
<a name="l00862"></a>00862          tempNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#adbe273c2b99dc5e32295b70ecc5a102">type</a> = <a class="code" href="constant_8h.html#308e894d9961d36b503cb11f28f8aa8e">AND_CE</a>;
<a name="l00863"></a>00863          tempNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#c38564da23a2a836bbce6cd2fcc1b761">logical</a> = logical;
<a name="l00864"></a>00864          tempNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a> = theGroup;
<a name="l00865"></a>00865         }
<a name="l00866"></a>00866      }
<a name="l00867"></a>00867 
<a name="l00868"></a>00868    <span class="comment">/*================*/</span>
<a name="l00869"></a>00869    <span class="comment">/* Return the CE. */</span>
<a name="l00870"></a>00870    <span class="comment">/*================*/</span>
<a name="l00871"></a>00871 
<a name="l00872"></a>00872    <span class="keywordflow">return</span>(theNode);
<a name="l00873"></a>00873   }
<a name="l00874"></a>00874 
<a name="l00875"></a>00875 <span class="comment">/***********************************************/</span>
<a name="l00876"></a>00876 <span class="comment">/* GroupPatterns: Groups a series of connected */</span>
<a name="l00877"></a>00877 <span class="comment">/*   conditional elements together.            */</span>
<a name="l00878"></a>00878 <span class="comment">/***********************************************/</span>
<a name="l00879"></a>00879 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *GroupPatterns(
<a name="l00880"></a>00880   <span class="keywordtype">void</span> *theEnv,
<a name="l00881"></a>00881   <span class="keywordtype">char</span> *readSource,
<a name="l00882"></a>00882   <span class="keywordtype">int</span> terminator,
<a name="l00883"></a>00883   <span class="keywordtype">char</span> *terminatorString,
<a name="l00884"></a>00884   <span class="keywordtype">int</span> *error)
<a name="l00885"></a>00885   {
<a name="l00886"></a>00886    <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *lastNode, *newNode, *theNode;
<a name="l00887"></a>00887 
<a name="l00888"></a>00888    lastNode = theNode = NULL;
<a name="l00889"></a>00889 
<a name="l00890"></a>00890    <span class="keywordflow">while</span> (<a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l00891"></a>00891      {
<a name="l00892"></a>00892       <span class="comment">/*==================*/</span>
<a name="l00893"></a>00893       <span class="comment">/* Get the next CE. */</span>
<a name="l00894"></a>00894       <span class="comment">/*==================*/</span>
<a name="l00895"></a>00895 
<a name="l00896"></a>00896       newNode = LHSPattern(theEnv,readSource,terminator,terminatorString,
<a name="l00897"></a>00897                            error,<a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>,NULL,NULL);
<a name="l00898"></a>00898 
<a name="l00899"></a>00899       <span class="comment">/*=======================================================*/</span>
<a name="l00900"></a>00900       <span class="comment">/* If an error occurred, release any LHS data structures */</span>
<a name="l00901"></a>00901       <span class="comment">/* previously allocated by this routine.                 */</span>
<a name="l00902"></a>00902       <span class="comment">/*=======================================================*/</span>
<a name="l00903"></a>00903 
<a name="l00904"></a>00904       <span class="keywordflow">if</span> (*error)
<a name="l00905"></a>00905         {
<a name="l00906"></a>00906          <a class="code" href="reorder_8c.html#36adfa94188ac9a3092e8a19d19312c9">ReturnLHSParseNodes</a>(theEnv,theNode);
<a name="l00907"></a>00907          <span class="keywordflow">return</span>(NULL);
<a name="l00908"></a>00908         }
<a name="l00909"></a>00909 
<a name="l00910"></a>00910       <span class="comment">/*===============================================*/</span>
<a name="l00911"></a>00911       <span class="comment">/* A NULL value for the CE just parsed indicates */</span>
<a name="l00912"></a>00912       <span class="comment">/* that the terminator for the group of patterns */</span>
<a name="l00913"></a>00913       <span class="comment">/* was encountered (either a "=&gt;" or a ")".      */</span>
<a name="l00914"></a>00914       <span class="comment">/*===============================================*/</span>
<a name="l00915"></a>00915 
<a name="l00916"></a>00916       <span class="keywordflow">if</span> (newNode == NULL)
<a name="l00917"></a>00917         {
<a name="l00918"></a>00918          <a class="code" href="pprint_8c.html#75a1ee27916fd946d264b1f0e6f6abd0">PPBackup</a>(theEnv);
<a name="l00919"></a>00919          <a class="code" href="pprint_8c.html#75a1ee27916fd946d264b1f0e6f6abd0">PPBackup</a>(theEnv);
<a name="l00920"></a>00920          <span class="keywordflow">if</span> (terminator == <a class="code" href="constant_8h.html#61df4d037757ddf4c87aaa6405438cb2">RPAREN</a>)
<a name="l00921"></a>00921            { <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,terminatorString); }
<a name="l00922"></a>00922          <span class="keywordflow">else</span>
<a name="l00923"></a>00923            {
<a name="l00924"></a>00924             <a class="code" href="pprint_8c.html#5e134cd66ac894adf35c7e385aec86ea">PPCRAndIndent</a>(theEnv);
<a name="l00925"></a>00925             <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,terminatorString);
<a name="l00926"></a>00926            }
<a name="l00927"></a>00927 
<a name="l00928"></a>00928          <span class="keywordflow">return</span>(theNode);
<a name="l00929"></a>00929         }
<a name="l00930"></a>00930 
<a name="l00931"></a>00931       <span class="comment">/*============================*/</span>
<a name="l00932"></a>00932       <span class="comment">/* Add the new CE to the list */</span>
<a name="l00933"></a>00933       <span class="comment">/* of CEs being grouped.      */</span>
<a name="l00934"></a>00934       <span class="comment">/*============================*/</span>
<a name="l00935"></a>00935 
<a name="l00936"></a>00936       <span class="keywordflow">if</span> (lastNode == NULL)
<a name="l00937"></a>00937         { theNode = newNode; }
<a name="l00938"></a>00938       <span class="keywordflow">else</span>
<a name="l00939"></a>00939         { lastNode-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a> = newNode; }
<a name="l00940"></a>00940 
<a name="l00941"></a>00941       lastNode = newNode;
<a name="l00942"></a>00942 
<a name="l00943"></a>00943       <span class="comment">/*======================================*/</span>
<a name="l00944"></a>00944       <span class="comment">/* Fix the pretty print representation. */</span>
<a name="l00945"></a>00945       <span class="comment">/*======================================*/</span>
<a name="l00946"></a>00946 
<a name="l00947"></a>00947       <a class="code" href="pprint_8c.html#5e134cd66ac894adf35c7e385aec86ea">PPCRAndIndent</a>(theEnv);
<a name="l00948"></a>00948      }
<a name="l00949"></a>00949   }
<a name="l00950"></a>00950 
<a name="l00951"></a>00951 <span class="comment">/**************************************************************/</span>
<a name="l00952"></a>00952 <span class="comment">/* TestPattern: Handles parsing of test conditional elements. */</span>
<a name="l00953"></a>00953 <span class="comment">/*                                                            */</span>
<a name="l00954"></a>00954 <span class="comment">/* &lt;test-CE&gt; ::= (test &lt;function-call&gt;)                       */</span>
<a name="l00955"></a>00955 <span class="comment">/**************************************************************/</span>
<a name="l00956"></a>00956 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *TestPattern(
<a name="l00957"></a>00957   <span class="keywordtype">void</span> *theEnv,
<a name="l00958"></a>00958   <span class="keywordtype">char</span> *readSource,
<a name="l00959"></a>00959   <span class="keywordtype">int</span> *error)
<a name="l00960"></a>00960   {
<a name="l00961"></a>00961    <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *theNode;
<a name="l00962"></a>00962    <span class="keyword">struct </span><a class="code" href="structtoken.html">token</a> theToken;
<a name="l00963"></a>00963    <span class="keyword">struct </span><a class="code" href="structexpr.html">expr</a> *theExpression;
<a name="l00964"></a>00964 
<a name="l00965"></a>00965    <span class="comment">/*================================================*/</span>
<a name="l00966"></a>00966    <span class="comment">/* Create the data specification for the test CE. */</span>
<a name="l00967"></a>00967    <span class="comment">/*================================================*/</span>
<a name="l00968"></a>00968 
<a name="l00969"></a>00969    <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,<span class="stringliteral">" "</span>);
<a name="l00970"></a>00970    theNode = <a class="code" href="reorder_8c.html#cd64b0e53ce385e6e9233008738e1d6a">GetLHSParseNode</a>(theEnv);
<a name="l00971"></a>00971    theNode-&gt;<a class="code" href="structlhsParseNode.html#adbe273c2b99dc5e32295b70ecc5a102">type</a> = <a class="code" href="constant_8h.html#8781b68b2ef425ed8493e2833901bff4">TEST_CE</a>;
<a name="l00972"></a>00972    theExpression = <a class="code" href="exprnpsr_8c.html#c0411992aae66ccfac8294152006c163">Function0Parse</a>(theEnv,readSource);
<a name="l00973"></a>00973    theNode-&gt;<a class="code" href="structlhsParseNode.html#e132056a38f38afdeedc66bd6ac20e97">expression</a> = <a class="code" href="reorder_8c.html#2a6b5638b1570aa4b851e277a6112be9">ExpressionToLHSParseNodes</a>(theEnv,theExpression);
<a name="l00974"></a>00974    <a class="code" href="expressn_8c.html#3b603498bfe0cfebe274e8402137a602">ReturnExpression</a>(theEnv,theExpression);
<a name="l00975"></a>00975 
<a name="l00976"></a>00976    <span class="keywordflow">if</span> (theNode-&gt;<a class="code" href="structlhsParseNode.html#e132056a38f38afdeedc66bd6ac20e97">expression</a> == NULL)
<a name="l00977"></a>00977      {
<a name="l00978"></a>00978       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00979"></a>00979       <a class="code" href="reorder_8c.html#36adfa94188ac9a3092e8a19d19312c9">ReturnLHSParseNodes</a>(theEnv,theNode);
<a name="l00980"></a>00980       <span class="keywordflow">return</span>(NULL);
<a name="l00981"></a>00981      }
<a name="l00982"></a>00982 
<a name="l00983"></a>00983    <span class="comment">/*=========================================================*/</span>
<a name="l00984"></a>00984    <span class="comment">/* Check for the closing right parenthesis of the test CE. */</span>
<a name="l00985"></a>00985    <span class="comment">/*=========================================================*/</span>
<a name="l00986"></a>00986 
<a name="l00987"></a>00987    <a class="code" href="scanner_8c.html#e909573743f1f7fd3b00d28c96f6a7d3">GetToken</a>(theEnv,readSource,&amp;theToken);
<a name="l00988"></a>00988    <span class="keywordflow">if</span> (theToken.<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> != <a class="code" href="constant_8h.html#61df4d037757ddf4c87aaa6405438cb2">RPAREN</a>)
<a name="l00989"></a>00989      {
<a name="l00990"></a>00990       <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"test conditional element"</span>);
<a name="l00991"></a>00991       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00992"></a>00992       <a class="code" href="reorder_8c.html#36adfa94188ac9a3092e8a19d19312c9">ReturnLHSParseNodes</a>(theEnv,theNode);
<a name="l00993"></a>00993       <span class="keywordflow">return</span>(NULL);
<a name="l00994"></a>00994      }
<a name="l00995"></a>00995 
<a name="l00996"></a>00996    <span class="comment">/*=====================*/</span>
<a name="l00997"></a>00997    <span class="comment">/* Return the test CE. */</span>
<a name="l00998"></a>00998    <span class="comment">/*=====================*/</span>
<a name="l00999"></a>00999 
<a name="l01000"></a>01000    <span class="keywordflow">return</span>(theNode);
<a name="l01001"></a>01001   }
<a name="l01002"></a>01002 
<a name="l01003"></a>01003 <span class="comment">/****************************************************************/</span>
<a name="l01004"></a>01004 <span class="comment">/* AssignmentParse: Finishes the parsing of pattern conditional */</span>
<a name="l01005"></a>01005 <span class="comment">/*   elements that have been bound to a  variable.              */</span>
<a name="l01006"></a>01006 <span class="comment">/*                                                              */</span>
<a name="l01007"></a>01007 <span class="comment">/* &lt;assigned-pattern-CE&gt; ::= ?&lt;variable-symbol&gt; &lt;- &lt;pattern-CE&gt; */</span>
<a name="l01008"></a>01008 <span class="comment">/****************************************************************/</span>
<a name="l01009"></a>01009 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *AssignmentParse(
<a name="l01010"></a>01010   <span class="keywordtype">void</span> *theEnv,
<a name="l01011"></a>01011   <span class="keywordtype">char</span> *readSource,
<a name="l01012"></a>01012   <a class="code" href="structsymbolHashNode.html">SYMBOL_HN</a> *factAddress,
<a name="l01013"></a>01013   <span class="keywordtype">int</span> *error)
<a name="l01014"></a>01014   {
<a name="l01015"></a>01015    <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *theNode;
<a name="l01016"></a>01016    <span class="keyword">struct </span><a class="code" href="structtoken.html">token</a> theToken;
<a name="l01017"></a>01017 
<a name="l01018"></a>01018    <span class="comment">/*=====================================================*/</span>
<a name="l01019"></a>01019    <span class="comment">/* Patterns cannot be bound if they are with a not CE. */</span>
<a name="l01020"></a>01020    <span class="comment">/*=====================================================*/</span>
<a name="l01021"></a>01021 
<a name="l01022"></a>01022    <span class="keywordflow">if</span> (<a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;WithinNotCE)
<a name="l01023"></a>01023      {
<a name="l01024"></a>01024       <a class="code" href="prntutil_8c.html#fbf692a39a683a2f1bd16185a376ae4e">PrintErrorID</a>(theEnv,<span class="stringliteral">"RULELHS"</span>,2,<a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);
<a name="l01025"></a>01025       <a class="code" href="router_8c.html#b440fbdc73d01def2c24bc96adbf4aeb">EnvPrintRouter</a>(theEnv,<a class="code" href="router_8h.html#bdc841279c3796079bf651d161b136cc">WERROR</a>,<span class="stringliteral">"A pattern CE cannot be bound to a pattern-address within a not CE\n"</span>);
<a name="l01026"></a>01026       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01027"></a>01027       <span class="keywordflow">return</span>(NULL);
<a name="l01028"></a>01028      }
<a name="l01029"></a>01029 
<a name="l01030"></a>01030    <span class="comment">/*===============================================*/</span>
<a name="l01031"></a>01031    <span class="comment">/* Check for binder token, "&lt;-", after variable. */</span>
<a name="l01032"></a>01032    <span class="comment">/*===============================================*/</span>
<a name="l01033"></a>01033 
<a name="l01034"></a>01034    <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,<span class="stringliteral">" "</span>);
<a name="l01035"></a>01035 
<a name="l01036"></a>01036    <a class="code" href="scanner_8c.html#e909573743f1f7fd3b00d28c96f6a7d3">GetToken</a>(theEnv,readSource,&amp;theToken);
<a name="l01037"></a>01037 
<a name="l01038"></a>01038    <span class="keywordflow">if</span> ((theToken.<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> == <a class="code" href="constant_8h.html#5f9ae9ce6aa6f82108b260135b2e63a0">SYMBOL</a>) ? (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken.<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"&lt;-"</span>) != 0) :
<a name="l01039"></a>01039                                    <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l01040"></a>01040      {
<a name="l01041"></a>01041       <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"binding patterns"</span>);
<a name="l01042"></a>01042       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01043"></a>01043       <span class="keywordflow">return</span>(NULL);
<a name="l01044"></a>01044      }
<a name="l01045"></a>01045 
<a name="l01046"></a>01046    <a class="code" href="pprint_8c.html#14935038c4b2f80b0aacc0c0788d25e5">SavePPBuffer</a>(theEnv,<span class="stringliteral">" "</span>);
<a name="l01047"></a>01047 
<a name="l01048"></a>01048    <span class="comment">/*================================================*/</span>
<a name="l01049"></a>01049    <span class="comment">/* Check for opening left parenthesis of pattern. */</span>
<a name="l01050"></a>01050    <span class="comment">/*================================================*/</span>
<a name="l01051"></a>01051 
<a name="l01052"></a>01052    <a class="code" href="scanner_8c.html#e909573743f1f7fd3b00d28c96f6a7d3">GetToken</a>(theEnv,readSource,&amp;theToken);
<a name="l01053"></a>01053    <span class="keywordflow">if</span> (theToken.<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> != <a class="code" href="constant_8h.html#be30756b10aa77b095a8737a0d0b63ef">LPAREN</a>)
<a name="l01054"></a>01054      {
<a name="l01055"></a>01055       <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"binding patterns"</span>);
<a name="l01056"></a>01056       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01057"></a>01057       <span class="keywordflow">return</span>(NULL);
<a name="l01058"></a>01058      }
<a name="l01059"></a>01059 
<a name="l01060"></a>01060    <span class="comment">/*======================================================*/</span>
<a name="l01061"></a>01061    <span class="comment">/* Parse the pattern and return the data specification. */</span>
<a name="l01062"></a>01062    <span class="comment">/*======================================================*/</span>
<a name="l01063"></a>01063 
<a name="l01064"></a>01064    <a class="code" href="scanner_8c.html#e909573743f1f7fd3b00d28c96f6a7d3">GetToken</a>(theEnv,readSource,&amp;theToken);
<a name="l01065"></a>01065 
<a name="l01066"></a>01066    theNode = SimplePatternParse(theEnv,readSource,&amp;theToken,error);
<a name="l01067"></a>01067 
<a name="l01068"></a>01068    <span class="keywordflow">if</span> (*error == <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l01069"></a>01069      {
<a name="l01070"></a>01070       <a class="code" href="reorder_8c.html#36adfa94188ac9a3092e8a19d19312c9">ReturnLHSParseNodes</a>(theEnv,theNode);
<a name="l01071"></a>01071       <span class="keywordflow">return</span>(NULL);
<a name="l01072"></a>01072      }
<a name="l01073"></a>01073 
<a name="l01074"></a>01074    <span class="comment">/*=============================================*/</span>
<a name="l01075"></a>01075    <span class="comment">/* Store the name of the variable to which the */</span>
<a name="l01076"></a>01076    <span class="comment">/* pattern is bound and return the pattern.    */</span>
<a name="l01077"></a>01077    <span class="comment">/*=============================================*/</span>
<a name="l01078"></a>01078 
<a name="l01079"></a>01079    theNode-&gt;<a class="code" href="structlhsParseNode.html#b65634cbd5a41cbb42d883edd7c3bd87">value</a> = (<span class="keywordtype">void</span> *) factAddress;
<a name="l01080"></a>01080    <span class="keywordflow">return</span>(theNode);
<a name="l01081"></a>01081   }
<a name="l01082"></a>01082 
<a name="l01083"></a>01083 <span class="comment">/************************************************************/</span>
<a name="l01084"></a>01084 <span class="comment">/* TagLHSLogicalNodes: Marks all *and*, *or*, and *not* CEs */</span>
<a name="l01085"></a>01085 <span class="comment">/*   contained within a logical CE as having the properties */</span>
<a name="l01086"></a>01086 <span class="comment">/*   associated with a logical CE.                          */</span>
<a name="l01087"></a>01087 <span class="comment">/************************************************************/</span>
<a name="l01088"></a>01088 <span class="keyword">static</span> <span class="keywordtype">void</span> TagLHSLogicalNodes(
<a name="l01089"></a>01089   <span class="keyword">struct</span> <a class="code" href="structlhsParseNode.html">lhsParseNode</a> *nodePtr)
<a name="l01090"></a>01090   {
<a name="l01091"></a>01091    <span class="keywordflow">while</span> (nodePtr != NULL)
<a name="l01092"></a>01092      {
<a name="l01093"></a>01093       nodePtr-&gt;<a class="code" href="structlhsParseNode.html#c38564da23a2a836bbce6cd2fcc1b761">logical</a> = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01094"></a>01094       <span class="keywordflow">if</span> ((nodePtr-&gt;<a class="code" href="structlhsParseNode.html#adbe273c2b99dc5e32295b70ecc5a102">type</a> == <a class="code" href="constant_8h.html#308e894d9961d36b503cb11f28f8aa8e">AND_CE</a>) ||
<a name="l01095"></a>01095           (nodePtr-&gt;<a class="code" href="structlhsParseNode.html#adbe273c2b99dc5e32295b70ecc5a102">type</a> == <a class="code" href="constant_8h.html#515f3141cc703d99b725cd1f8dd18265">OR_CE</a>) ||
<a name="l01096"></a>01096           (nodePtr-&gt;<a class="code" href="structlhsParseNode.html#adbe273c2b99dc5e32295b70ecc5a102">type</a> == <a class="code" href="constant_8h.html#0ad99db1679eed3eea9341cc242e83d8">NOT_CE</a>))
<a name="l01097"></a>01097         { TagLHSLogicalNodes(nodePtr-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>); }
<a name="l01098"></a>01098       nodePtr = nodePtr-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a>;
<a name="l01099"></a>01099      }
<a name="l01100"></a>01100   }
<a name="l01101"></a>01101 
<a name="l01102"></a>01102 <span class="comment">/***********************************************************/</span>
<a name="l01103"></a>01103 <span class="comment">/* SimplePatternParse: Parses a simple pattern (an opening */</span>
<a name="l01104"></a>01104 <span class="comment">/*   parenthesis followed by one or more fields followed   */</span>
<a name="l01105"></a>01105 <span class="comment">/*   by a closing parenthesis).                            */</span>
<a name="l01106"></a>01106 <span class="comment">/*                                                         */</span>
<a name="l01107"></a>01107 <span class="comment">/* &lt;pattern-CE&gt; ::= &lt;ordered-pattern-CE&gt; |                 */</span>
<a name="l01108"></a>01108 <span class="comment">/*                  &lt;template-pattern-CE&gt;                  */</span>
<a name="l01109"></a>01109 <span class="comment">/***********************************************************/</span>
<a name="l01110"></a>01110 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *SimplePatternParse(
<a name="l01111"></a>01111   <span class="keywordtype">void</span> *theEnv,
<a name="l01112"></a>01112   <span class="keywordtype">char</span> *readSource,
<a name="l01113"></a>01113   <span class="keyword">struct</span> <a class="code" href="structtoken.html">token</a> *theToken,
<a name="l01114"></a>01114   <span class="keywordtype">int</span> *error)
<a name="l01115"></a>01115   {
<a name="l01116"></a>01116    <span class="keyword">struct </span><a class="code" href="structlhsParseNode.html">lhsParseNode</a> *theNode;
<a name="l01117"></a>01117    <span class="keyword">struct </span><a class="code" href="structpatternParser.html">patternParser</a> *tempParser;
<a name="l01118"></a>01118 
<a name="l01119"></a>01119    <span class="comment">/*=================================================*/</span>
<a name="l01120"></a>01120    <span class="comment">/* The first field of a pattern must be a symbol.  */</span>
<a name="l01121"></a>01121    <span class="comment">/* In addition, the symbols ":" and "=" can not    */</span>
<a name="l01122"></a>01122    <span class="comment">/* be used because they have special significance. */</span>
<a name="l01123"></a>01123    <span class="comment">/*=================================================*/</span>
<a name="l01124"></a>01124 
<a name="l01125"></a>01125    <span class="keywordflow">if</span> (theToken-&gt;<a class="code" href="structtoken.html#c2f382aedd4d786a85876157e4b9915e">type</a> != <a class="code" href="constant_8h.html#5f9ae9ce6aa6f82108b260135b2e63a0">SYMBOL</a>)
<a name="l01126"></a>01126      {
<a name="l01127"></a>01127       <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"the first field of a pattern"</span>);
<a name="l01128"></a>01128       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01129"></a>01129       <span class="keywordflow">return</span>(NULL);
<a name="l01130"></a>01130      }
<a name="l01131"></a>01131    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken-&gt;<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">"="</span>) == 0) ||
<a name="l01132"></a>01132             (strcmp(<a class="code" href="symbol_8h.html#5516efcb670dd7c739b33b7feffd6e01">ValueToString</a>(theToken-&gt;<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>),<span class="stringliteral">":"</span>) == 0))
<a name="l01133"></a>01133      {
<a name="l01134"></a>01134       <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"the field field of a pattern"</span>);
<a name="l01135"></a>01135       *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01136"></a>01136       <span class="keywordflow">return</span>(NULL);
<a name="l01137"></a>01137      }
<a name="l01138"></a>01138 
<a name="l01139"></a>01139    <span class="comment">/*===============================================*/</span>
<a name="l01140"></a>01140    <span class="comment">/* Construct the topmost node of the pattern CE. */</span>
<a name="l01141"></a>01141    <span class="comment">/*===============================================*/</span>
<a name="l01142"></a>01142 
<a name="l01143"></a>01143    theNode = <a class="code" href="reorder_8c.html#cd64b0e53ce385e6e9233008738e1d6a">GetLHSParseNode</a>(theEnv);
<a name="l01144"></a>01144    theNode-&gt;<a class="code" href="structlhsParseNode.html#adbe273c2b99dc5e32295b70ecc5a102">type</a> = <a class="code" href="constant_8h.html#67450b5737c5ed7b22521dad30a2ad66">PATTERN_CE</a>;
<a name="l01145"></a>01145    theNode-&gt;<a class="code" href="structlhsParseNode.html#7d892017be4ccb99d062c755bff45cec">negated</a> = <a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01146"></a>01146    theNode-&gt;<a class="code" href="structlhsParseNode.html#9e956f2b1eeeb72c17ac44ff256c0b26">exists</a> = <a class="code" href="xclips_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l01147"></a>01147 
<a name="l01148"></a>01148    <span class="comment">/*======================================================*/</span>
<a name="l01149"></a>01149    <span class="comment">/* Search for a pattern parser that claims the pattern. */</span>
<a name="l01150"></a>01150    <span class="comment">/*======================================================*/</span>
<a name="l01151"></a>01151 
<a name="l01152"></a>01152    <span class="keywordflow">for</span> (tempParser = <a class="code" href="pattern_8h.html#410f6ad967e1466b5264ea80c3122b90">PatternData</a>(theEnv)-&gt;ListOfPatternParsers;
<a name="l01153"></a>01153         tempParser != NULL;
<a name="l01154"></a>01154         tempParser = tempParser-&gt;<a class="code" href="structpatternParser.html#0e92f4279bc11ed7867bf0d780605b2a">next</a>)
<a name="l01155"></a>01155      {
<a name="l01156"></a>01156       <span class="keywordflow">if</span> ((*tempParser-&gt;<a class="code" href="structpatternParser.html#04c78a7ac537c01d6aafaa8fa0561ee1">recognizeFunction</a>)((<a class="code" href="structsymbolHashNode.html">SYMBOL_HN</a> *) theToken-&gt;<a class="code" href="structtoken.html#61e184b561df7f4f0f26c94faa0f3f69">value</a>))
<a name="l01157"></a>01157         {
<a name="l01158"></a>01158          theNode-&gt;<a class="code" href="structlhsParseNode.html#d8e4c787cb68b9508323e3f75b953742">patternType</a> = tempParser;
<a name="l01159"></a>01159          theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a> = (*tempParser-&gt;<a class="code" href="structpatternParser.html#d4bda8bd6f82bfadeb67fb6e142d762e">parseFunction</a>)(theEnv,readSource,theToken);
<a name="l01160"></a>01160          <span class="keywordflow">if</span> (theNode-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a> == NULL)
<a name="l01161"></a>01161            {
<a name="l01162"></a>01162             *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01163"></a>01163             <a class="code" href="reorder_8c.html#36adfa94188ac9a3092e8a19d19312c9">ReturnLHSParseNodes</a>(theEnv,theNode);
<a name="l01164"></a>01164             <span class="keywordflow">return</span>(NULL);
<a name="l01165"></a>01165            }
<a name="l01166"></a>01166 
<a name="l01167"></a>01167          <a class="code" href="rulelhs_8c.html#682a827317af7448309a26a1f8c0558a">PropagatePatternType</a>(theNode,tempParser);
<a name="l01168"></a>01168          <span class="keywordflow">return</span>(theNode);
<a name="l01169"></a>01169         }
<a name="l01170"></a>01170      }
<a name="l01171"></a>01171 
<a name="l01172"></a>01172    <span class="comment">/*=================================*/</span>
<a name="l01173"></a>01173    <span class="comment">/* If a pattern parser couldn't be */</span>
<a name="l01174"></a>01174    <span class="comment">/* found, then signal an error.    */</span>
<a name="l01175"></a>01175    <span class="comment">/*=================================*/</span>
<a name="l01176"></a>01176 
<a name="l01177"></a>01177    *error = <a class="code" href="xclips_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l01178"></a>01178    <a class="code" href="prntutil_8c.html#f7919db6ca1dc6195b35d3562b27ca7f">SyntaxErrorMessage</a>(theEnv,<span class="stringliteral">"the field field of a pattern"</span>);
<a name="l01179"></a>01179    <a class="code" href="reorder_8c.html#36adfa94188ac9a3092e8a19d19312c9">ReturnLHSParseNodes</a>(theEnv,theNode);
<a name="l01180"></a>01180    <span class="keywordflow">return</span>(NULL);
<a name="l01181"></a>01181   }
<a name="l01182"></a>01182 
<a name="l01183"></a>01183 <span class="comment">/**************************************************************/</span>
<a name="l01184"></a>01184 <span class="comment">/* PropagatePatternType: Sets the selfPattern field for all   */</span>
<a name="l01185"></a>01185 <span class="comment">/*   lhsParseNodes in a linked list of those data structures. */</span>
<a name="l01186"></a>01186 <span class="comment">/**************************************************************/</span>
<a name="l01187"></a><a class="code" href="rulelhs_8h.html#9cdbfb0e3fc4140eabeb449da53789d0">01187</a> <a class="code" href="setup_8h.html#62417931fe8ecc3bd4d0051db7687573">globle</a> <span class="keywordtype">void</span> <a class="code" href="rulelhs_8c.html#682a827317af7448309a26a1f8c0558a">PropagatePatternType</a>(
<a name="l01188"></a>01188   <span class="keyword">struct</span> <a class="code" href="structlhsParseNode.html">lhsParseNode</a> *theLHS,
<a name="l01189"></a>01189   <span class="keyword">struct</span> <a class="code" href="structpatternParser.html">patternParser</a> *theParser)
<a name="l01190"></a>01190   {
<a name="l01191"></a>01191    <span class="keywordflow">while</span> (theLHS != NULL)
<a name="l01192"></a>01192      {
<a name="l01193"></a>01193       theLHS-&gt;<a class="code" href="structlhsParseNode.html#d8e4c787cb68b9508323e3f75b953742">patternType</a> = theParser;
<a name="l01194"></a>01194       <span class="keywordflow">if</span> (theLHS-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a> != NULL) <a class="code" href="rulelhs_8c.html#682a827317af7448309a26a1f8c0558a">PropagatePatternType</a>(theLHS-&gt;<a class="code" href="structlhsParseNode.html#d1e6509510eda787caa5ca522cdd4dd7">right</a>,theParser);
<a name="l01195"></a>01195       <span class="keywordflow">if</span> (theLHS-&gt;<a class="code" href="structlhsParseNode.html#e132056a38f38afdeedc66bd6ac20e97">expression</a> != NULL) <a class="code" href="rulelhs_8c.html#682a827317af7448309a26a1f8c0558a">PropagatePatternType</a>(theLHS-&gt;<a class="code" href="structlhsParseNode.html#e132056a38f38afdeedc66bd6ac20e97">expression</a>,theParser);
<a name="l01196"></a>01196       theLHS = theLHS-&gt;<a class="code" href="structlhsParseNode.html#2829a3fd0dce6298944a8d1eb9683d70">bottom</a>;
<a name="l01197"></a>01197      }
<a name="l01198"></a>01198   }
<a name="l01199"></a>01199 
<a name="l01200"></a>01200 <span class="preprocessor">#endif </span><span class="comment">/* (! RUN_TIME) &amp;&amp; (! BLOAD_ONLY) &amp;&amp;  DEFRULE_CONSTRUCT */</span>
<a name="l01201"></a>01201 
<a name="l01202"></a>01202 
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jan 10 23:49:16 2011 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
